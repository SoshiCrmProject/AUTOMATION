"use strict";(()=>{var e={};e.id=157,e.ids=[157,660],e.modules={8034:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{config:()=>j,default:()=>u,getServerSideProps:()=>x,getStaticPaths:()=>p,getStaticProps:()=>m,reportWebVitals:()=>y,routeModule:()=>f,unstable_getServerProps:()=>S,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>g});var r=s(8877),n=s(4591),l=s(6021),d=s(552),i=s.n(d),o=s(5270),c=s(5289),h=e([c]);c=(h.then?(await h)():h)[0];let u=(0,l.l)(c,"default"),m=(0,l.l)(c,"getStaticProps"),p=(0,l.l)(c,"getStaticPaths"),x=(0,l.l)(c,"getServerSideProps"),j=(0,l.l)(c,"config"),y=(0,l.l)(c,"reportWebVitals"),g=(0,l.l)(c,"unstable_getStaticProps"),b=(0,l.l)(c,"unstable_getStaticPaths"),v=(0,l.l)(c,"unstable_getStaticParams"),S=(0,l.l)(c,"unstable_getServerProps"),N=(0,l.l)(c,"unstable_getServerSideProps"),f=new r.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/inventory",pathname:"/inventory",bundlePath:"",filename:""},components:{App:o.default,Document:i()},userland:c});a()}catch(e){a(e)}})},404:(e,t,s)=>{s.d(t,{Z:()=>d});var a=s(997),r=s(1377),n=s(6689),l=s(1703);function d({isOpen:e,onClose:t,onSubmit:s,title:d,fields:i,size:o="md",submitLabel:c,cancelLabel:h}){let{t:u}=(0,r.useTranslation)("common"),[m,p]=(0,n.useState)({}),[x,j]=(0,n.useState)(!1),[y,g]=(0,n.useState)(null),b=(e,t)=>{p(s=>({...s,[e]:t}))},v=async e=>{e.preventDefault(),g(null),j(!0);try{await s(m),p({}),t()}catch(e){g(e.message||"An error occurred")}finally{j(!1)}},S=()=>{p({}),g(null),t()};return a.jsx(l.Z,{isOpen:e,onClose:S,title:d,size:o,children:(0,a.jsxs)("form",{onSubmit:v,className:"form-modal",children:[y&&a.jsx("div",{className:"alert alert-error",children:(0,a.jsxs)("span",{children:["⚠️ ",y]})}),a.jsx("div",{className:"form-grid",children:i.map(e=>(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:e.name,className:"form-label",children:[e.label,e.required&&a.jsx("span",{className:"text-danger",children:" *"})]}),"select"===e.type?(0,a.jsxs)("select",{id:e.name,value:m[e.name]||"",onChange:t=>b(e.name,t.target.value),required:e.required,className:"form-select",children:[a.jsx("option",{value:"",children:"Select..."}),e.options?.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))]}):"textarea"===e.type?a.jsx("textarea",{id:e.name,value:m[e.name]||"",onChange:t=>b(e.name,t.target.value),placeholder:e.placeholder,required:e.required,rows:4,className:"form-textarea"}):a.jsx("input",{id:e.name,type:e.type,value:m[e.name]||"",onChange:t=>b(e.name,"number"===e.type?Number(t.target.value):t.target.value),placeholder:e.placeholder,required:e.required,className:"form-input"})]},e.name))}),(0,a.jsxs)("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",onClick:S,className:"btn btn-secondary",disabled:x,children:h||u("cancel")}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:x,children:x?u("saving"):c||u("save")})]})]})})}},1703:(e,t,s)=>{s.d(t,{Z:()=>l});var a=s(997),r=s(1377),n=s(6689);function l({isOpen:e,onClose:t,title:s,children:l,size:d="md",showCloseButton:i=!0}){let{t:o}=(0,r.useTranslation)("common");return((0,n.useEffect)(()=>{let s=s=>{"Escape"===s.key&&e&&t()};return e&&(document.addEventListener("keydown",s),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",s),document.body.style.overflow="unset"}},[e,t]),e)?a.jsx("div",{className:"modal-overlay",onClick:t,children:(0,a.jsxs)("div",{className:`modal-content ${{sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"}[d]}`,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"modal-header",children:[a.jsx("h2",{className:"modal-title",children:s}),i&&a.jsx("button",{className:"modal-close",onClick:t,"aria-label":"Close",children:"✕"})]}),a.jsx("div",{className:"modal-body",children:l})]})}):null}},5289:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>x,getStaticProps:()=>j});var r=s(997),n=s(6689),l=s(5941),d=s(5460),i=s(1377),o=s(1522),c=s(2684),h=s(404),u=s(1703),m=s(7029),p=e([l,o]);[l,o]=p.then?(await p)():p;let y=e=>o.Z.get(e).then(e=>e.data);function x(){let{t:e}=(0,i.useTranslation)("common"),[t,s]=(0,n.useState)(""),[a,d]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!1),[j,g]=(0,n.useState)(!1),[b,v]=(0,n.useState)(null),{data:S,mutate:N}=(0,l.default)(t?`/api/inventory/${t}`:null,y),{data:f,mutate:w}=(0,l.default)(t?`/api/inventory/alerts/low-stock?shopId=${t}`:null,y),{data:k}=(0,l.default)(b?`/api/inventory/movements?productId=${b.productId}`:null,y),q=e=>{switch(e){case"IN_STOCK":return"success";case"LOW_STOCK":return"warning";case"OUT_OF_STOCK":return"error";default:return"info"}},C=async t=>{try{await o.Z.post(`/api/inventory/alerts/${t}/acknowledge`),(0,m.M)(e("acknowledged"),"success"),w()}catch(e){(0,m.M)("Failed to acknowledge alert","error")}},T=async e=>{try{await o.Z.post("/api/inventory/stock/adjust",{shopId:t,productId:e.productId,quantityChange:Number(e.quantity),reason:e.reason,location:e.location}),(0,m.M)("Stock added successfully","success"),N()}catch(e){throw Error(e.response?.data?.error||"Failed to add stock")}},P=async e=>{try{await o.Z.put(`/api/inventory/${b?.id}/threshold`,{threshold:Number(e.threshold)}),(0,m.M)("Threshold updated successfully","success"),N()}catch(e){throw Error(e.response?.data?.error||"Failed to update threshold")}};return(0,r.jsxs)("div",{className:"shell",children:[r.jsx(c.Z,{activeHref:"/inventory"}),(0,r.jsxs)("div",{className:"container",children:[(0,r.jsxs)("div",{className:"hero",style:{marginBottom:32},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{style:{fontSize:36,margin:0},children:["\uD83D\uDCE6 ",e("inventoryTitle")]}),r.jsx("p",{style:{color:"var(--text-secondary)",marginTop:8},children:e("inventoryDesc")})]}),(0,r.jsxs)("button",{className:"btn btn-primary",onClick:()=>d(!0),disabled:!t,children:["+ ",e("addStock")]})]}),(0,r.jsxs)("div",{className:"card",style:{marginBottom:24},children:[r.jsx("label",{className:"form-label",children:e("shopId")}),r.jsx("input",{className:"form-input",type:"text",placeholder:e("enterShopId"),value:t,onChange:e=>s(e.target.value)})]}),!t&&(0,r.jsxs)("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"\uD83D\uDCE6"}),r.jsx("h3",{children:e("getStarted")}),r.jsx("p",{children:e("enterShopIdDesc")})]}),t&&(0,r.jsxs)(r.Fragment,{children:[f&&f.length>0&&(0,r.jsxs)("div",{className:"card",style:{marginBottom:24},children:[(0,r.jsxs)("h3",{style:{marginTop:0,display:"flex",alignItems:"center",gap:12},children:[r.jsx("span",{children:"⚠️"})," ",e("lowStockAlerts"),r.jsx("span",{className:"badge badge-error",children:f.length})]}),r.jsx("div",{style:{display:"grid",gap:16},children:f.map(t=>(0,r.jsxs)("div",{className:"alert alert-warning",style:{justifyContent:"space-between"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("strong",{children:[e("productId"),": ",t.productId]}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",marginTop:4},children:[e("currentStock"),": ",t.currentStock," / ",e("threshold"),": ",t.threshold]})]}),!t.acknowledged&&r.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>C(t.id),children:e("acknowledge")})]},t.id))})]}),S&&S.length>0&&(0,r.jsxs)("div",{className:"card",children:[r.jsx("h3",{style:{marginTop:0},children:e("inventoryOverview")}),r.jsx("div",{className:"table-wrapper",children:(0,r.jsxs)("table",{className:"table",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:e("sku")}),r.jsx("th",{children:e("productId")}),r.jsx("th",{children:e("quantity")}),r.jsx("th",{children:e("location")}),r.jsx("th",{children:e("status")}),r.jsx("th",{children:e("threshold")}),r.jsx("th",{children:e("lastUpdated")}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:S.map(t=>(0,r.jsxs)("tr",{children:[r.jsx("td",{children:r.jsx("code",{children:t.sku})}),r.jsx("td",{children:t.productId}),r.jsx("td",{children:r.jsx("strong",{children:t.quantity})}),r.jsx("td",{children:t.location}),r.jsx("td",{children:r.jsx("span",{className:`badge badge-${q(t.status)}`,children:t.status})}),r.jsx("td",{children:t.lowStockThreshold}),r.jsx("td",{children:new Date(t.updatedAt).toLocaleDateString()}),r.jsx("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:8},children:[r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>{v(t),x(!0)},children:e("updateThreshold")}),r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>{v(t),g(!0)},children:e("stockHistory")})]})})]},t.id))})]})})]})]})]}),r.jsx(h.Z,{isOpen:a,onClose:()=>d(!1),onSubmit:T,title:e("addStock"),submitLabel:e("add"),fields:[{name:"productId",label:e("productId"),type:"text",required:!0},{name:"quantity",label:e("quantity"),type:"number",required:!0},{name:"location",label:e("location"),type:"text",required:!0},{name:"reason",label:"Reason",type:"textarea",placeholder:"Restock, return, etc."}]}),r.jsx(h.Z,{isOpen:p,onClose:()=>{x(!1),v(null)},onSubmit:P,title:e("updateThreshold"),submitLabel:e("update"),fields:[{name:"threshold",label:e("threshold"),type:"number",required:!0,placeholder:String(b?.lowStockThreshold||10)}]}),r.jsx(u.Z,{isOpen:j,onClose:()=>{g(!1),v(null)},title:e("stockHistory"),size:"lg",children:k&&k.length>0?(0,r.jsxs)("table",{className:"table",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:e("date")}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Change"}),r.jsx("th",{children:"Reason"}),r.jsx("th",{children:e("location")})]})}),r.jsx("tbody",{children:k.map(e=>(0,r.jsxs)("tr",{children:[r.jsx("td",{children:new Date(e.createdAt).toLocaleString()}),r.jsx("td",{children:r.jsx("span",{className:`badge badge-${"IN"===e.movementType?"success":"warning"}`,children:e.movementType})}),r.jsx("td",{children:(0,r.jsxs)("strong",{style:{color:e.quantityChange>0?"var(--success)":"var(--warning)"},children:[e.quantityChange>0?"+":"",e.quantityChange]})}),r.jsx("td",{children:e.reason||"N/A"}),r.jsx("td",{children:e.location||"N/A"})]},e.id))})]}):r.jsx("p",{style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:"No history available"})}),r.jsx(m.Z,{})]})}async function j({locale:e}){return{props:{...await (0,d.serverSideTranslations)(e,["common"])}}}a()}catch(e){a(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9648:e=>{e.exports=import("axios")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[332,839,552,754,52],()=>s(8034));module.exports=a})();