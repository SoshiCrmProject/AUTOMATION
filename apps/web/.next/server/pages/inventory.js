"use strict";(()=>{var e={};e.id=157,e.ids=[157,660],e.modules={8034:(e,t,r)=>{r.a(e,async(e,l)=>{try{r.r(t),r.d(t,{config:()=>v,default:()=>p,getServerSideProps:()=>g,getStaticPaths:()=>h,getStaticProps:()=>x,reportWebVitals:()=>m,routeModule:()=>f,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>k,unstable_getStaticParams:()=>S,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>y});var a=r(8877),s=r(4591),n=r(6021),i=r(552),o=r.n(i),d=r(5270),c=r(5289),u=e([c]);c=(u.then?(await u)():u)[0];let p=(0,n.l)(c,"default"),x=(0,n.l)(c,"getStaticProps"),h=(0,n.l)(c,"getStaticPaths"),g=(0,n.l)(c,"getServerSideProps"),v=(0,n.l)(c,"config"),m=(0,n.l)(c,"reportWebVitals"),y=(0,n.l)(c,"unstable_getStaticProps"),j=(0,n.l)(c,"unstable_getStaticPaths"),S=(0,n.l)(c,"unstable_getStaticParams"),b=(0,n.l)(c,"unstable_getServerProps"),k=(0,n.l)(c,"unstable_getServerSideProps"),f=new a.PagesRouteModule({definition:{kind:s.x.PAGES,page:"/inventory",pathname:"/inventory",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:c});l()}catch(e){l(e)}})},5289:(e,t,r)=>{r.a(e,async(e,l)=>{try{r.r(t),r.d(t,{default:()=>v,getStaticProps:()=>m});var a=r(997),s=r(6689),n=r(5941),i=r(5460),o=r(1377),d=r(1522),c=r(6555),u=r(7029),p=r(3688),x=r(1935),h=r(4202),g=e([n,d]);[n,d]=g.then?(await g)():g;let y=e=>d.Z.get(e).then(e=>e.data);function v(){let{t:e}=(0,o.useTranslation)("common"),[t,r]=(0,s.useState)(""),[l,i]=(0,s.useState)(!1),[g,v]=(0,s.useState)("all"),[m,j]=(0,s.useState)(""),[S,b]=(0,s.useState)(null),[k,f]=(0,s.useState)(!1),[C,w]=(0,s.useState)(!1),[I,D]=(0,s.useState)(0),[P,A]=(0,s.useState)("IN"),[T,N]=(0,s.useState)(""),[O,_]=(0,s.useState)(!1),[B,z]=(0,s.useState)({shopeeItemId:"",sku:"",productName:"",currentStock:0,costPrice:0,sellingPrice:0,lowStockThreshold:10,supplier:"",location:""}),{data:L,error:M,mutate:W}=(0,n.default)(t?`/api/inventory/${t}`:null,y),{data:Z,mutate:q}=(0,n.default)(t?`/api/inventory/alerts/low-stock?shopId=${t}`:null,y),F=!L&&!M&&t,R=Array.isArray(L?.inventory)?L.inventory:[],K=Array.isArray(Z)?Z:[],E=R.filter(e=>{let t="all"===g||e.status===g,r=!m||e.productName.toLowerCase().includes(m.toLowerCase())||e.sku.toLowerCase().includes(m.toLowerCase());return t&&r}),U=L?.stats?._sum?.currentStock||0,$=L?.stats?._sum?.availableStock||0,Q=L?.stats?._sum?.reservedStock||0,Y=L?.stats?._count||0,H=R.filter(e=>"LOW_STOCK"===e.status).length,V=R.filter(e=>"OUT_OF_STOCK"===e.status).length,G=async()=>{if(S&&0!==I){_(!0);try{await d.Z.post(`/api/inventory/${S.id}/adjust`,{quantity:Math.abs(I),type:P,reason:T||void 0}),(0,u.M)("Stock adjusted successfully","success"),W(),f(!1),D(0),N(""),b(null)}catch(e){(0,u.M)(e.response?.data?.error||"Failed to adjust stock","error")}_(!1)}},J=async()=>{if(!t||!B.shopeeItemId||!B.productName){(0,u.M)("Please fill in required fields","error");return}_(!0);try{await d.Z.post("/api/inventory",{shopId:t,...B}),(0,u.M)("Product added successfully","success"),W(),w(!1),z({shopeeItemId:"",sku:"",productName:"",currentStock:0,costPrice:0,sellingPrice:0,lowStockThreshold:10,supplier:"",location:""})}catch(e){(0,u.M)(e.response?.data?.error||"Failed to add product","error")}_(!1)},X=async e=>{try{await d.Z.post(`/api/inventory/alerts/${e}/acknowledge`),(0,u.M)("Alert acknowledged","success"),q()}catch(e){(0,u.M)("Failed to acknowledge alert","error")}},ee=async e=>{try{await d.Z.post(`/api/inventory/alerts/${e}/resolve`),(0,u.M)("Alert resolved","success"),q()}catch(e){(0,u.M)("Failed to resolve alert","error")}};return(0,a.jsxs)("div",{className:"shell",children:[a.jsx(c.Z,{activeHref:"/inventory"}),a.jsx(u.Z,{}),a.jsx(p.Z,{pageName:"inventory",steps:x.yf,onComplete:()=>i(!1)}),!l&&a.jsx(p.M,{onClick:()=>{}}),(0,a.jsxs)("div",{className:"container",children:[a.jsx("div",{style:{background:"linear-gradient(135deg, rgba(245, 158, 11, 0.08) 0%, rgba(59, 130, 246, 0.08) 100%)",borderRadius:"var(--radius-xl)",padding:"40px",marginBottom:"32px",border:"1px solid var(--color-border)"},children:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"20px"},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{style:{fontSize:"42px",margin:"0 0 12px 0",fontWeight:900,background:"linear-gradient(135deg, #f59e0b, #3b82f6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:["\uD83D\uDCE6 ",e("navInventory")||"Inventory Management"]}),a.jsx("p",{style:{color:"var(--color-text-muted)",margin:0,fontSize:"16px"},children:"Track stock levels, manage products, and monitor alerts"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexWrap:"wrap"},children:[a.jsx(h.zx,{onClick:()=>w(!0),disabled:!t,children:"➕ Add Product"}),a.jsx(h.zx,{onClick:()=>W(),variant:"ghost",children:"\uD83D\uDD04 Refresh"})]})]})}),!t&&a.jsx(h.bZ,{variant:"info",title:"Select Shop",children:"Enter your Shop ID to view and manage inventory"}),a.jsx("div",{style:{marginBottom:"24px"},children:a.jsx(h.II,{label:"Shop ID",value:t,onChange:e=>r(e.target.value),placeholder:"Enter your Shop ID",hint:"You can find this in your shop settings"})}),K.length>0&&a.jsx(h.bZ,{variant:"warning",title:`${K.length} Low Stock Alerts`,children:"You have products that need attention. Check the alerts tab below."}),t&&a.jsx(a.Fragment,{children:F?a.jsx(h.TK,{size:"lg",text:"Loading inventory..."}):M?a.jsx(h.bZ,{variant:"error",title:"Failed to Load Inventory",children:M.message||"Unable to fetch inventory data"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-4",style:{marginBottom:"32px"},children:[a.jsx(h.Rm,{label:"Total Products",value:Y,icon:"\uD83D\uDCE6",color:"primary"}),a.jsx(h.Rm,{label:"Total Stock",value:U,icon:"\uD83D\uDCCA",color:"info"}),a.jsx(h.Rm,{label:"Low Stock",value:H,icon:"⚠️",color:"warning"}),a.jsx(h.Rm,{label:"Out of Stock",value:V,icon:"\uD83D\uDEAB",color:"error"})]}),a.jsx("div",{style:{marginBottom:"24px"},children:(0,a.jsxs)(h.Zb,{children:[a.jsx(h.Ol,{title:"Filters",icon:"\uD83D\uDD0D"}),(0,a.jsxs)("div",{className:"grid grid-3",style:{gap:"16px"},children:[a.jsx(h.II,{label:"Search",value:m,onChange:e=>j(e.target.value),placeholder:"Product name or SKU..."}),a.jsx(h.Ph,{label:"Status",value:g,onChange:e=>v(e.target.value),options:[{value:"all",label:"All Status"},{value:"IN_STOCK",label:"In Stock"},{value:"LOW_STOCK",label:"Low Stock"},{value:"OUT_OF_STOCK",label:"Out of Stock"},{value:"DISCONTINUED",label:"Discontinued"}]}),a.jsx("div",{style:{display:"flex",alignItems:"flex-end",gap:"8px"},children:a.jsx(h.zx,{onClick:()=>{j(""),v("all")},variant:"ghost",fullWidth:!0,children:"Clear Filters"})})]})]})}),a.jsx("div",{style:{marginBottom:"32px"},children:a.jsx(h.Zb,{children:a.jsx(h.mQ,{tabs:[{id:"products",label:"Products",icon:"\uD83D\uDCE6",badge:E.length,content:a.jsx("div",{children:E.length>0?a.jsx(h.iA,{columns:[{key:"sku",header:"SKU",width:"120px"},{key:"productName",header:"Product Name"},{key:"status",header:"Status",width:"120px",render:e=>a.jsx(h.Ct,{variant:"IN_STOCK"===e.status?"success":"LOW_STOCK"===e.status?"warning":"OUT_OF_STOCK"===e.status?"error":"info",children:e.status.replace("_"," ")})},{key:"currentStock",header:"Stock",width:"100px",render:e=>a.jsx("span",{style:{fontWeight:600,color:e.currentStock<=e.lowStockThreshold?"var(--color-error)":"var(--color-text)"},children:e.currentStock})},{key:"available",header:"Available",width:"100px",render:e=>e.availableStock},{key:"location",header:"Location",width:"120px",render:e=>e.location||"-"},{key:"actions",header:"Actions",width:"150px",render:e=>a.jsx("div",{style:{display:"flex",gap:"8px"},children:a.jsx(h.zx,{size:"sm",variant:"primary",onClick:()=>{b(e),f(!0)},children:"Adjust"})})}],data:E,emptyMessage:"No products found"}):(0,a.jsxs)("div",{style:{padding:"60px",textAlign:"center"},children:[a.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"\uD83D\uDCE6"}),a.jsx("h3",{style:{marginBottom:"8px"},children:"No products found"}),a.jsx("p",{style:{color:"var(--color-text-muted)",marginBottom:"24px"},children:m||"all"!==g?"Try adjusting your filters":"Add your first product to get started"}),!m&&"all"===g&&a.jsx(h.zx,{onClick:()=>w(!0),children:"➕ Add Product"})]})})},{id:"alerts",label:"Alerts",icon:"\uD83D\uDD14",badge:K.filter(e=>!e.acknowledged).length,content:a.jsx("div",{children:K.length>0?a.jsx(h.iA,{columns:[{key:"productId",header:"Product",render:e=>{let t=R.find(t=>t.id===e.productId);return t?.productName||e.productId}},{key:"currentQty",header:"Current Stock",width:"120px",render:e=>a.jsx(h.Ct,{variant:"error",children:e.currentQty})},{key:"threshold",header:"Threshold",width:"100px"},{key:"notifiedAt",header:"Date",width:"150px",render:e=>new Date(e.notifiedAt).toLocaleDateString()},{key:"status",header:"Status",width:"120px",render:e=>a.jsx(h.Ct,{variant:e.acknowledged?"info":"warning",children:e.acknowledged?"Acknowledged":"New"})},{key:"actions",header:"Actions",width:"180px",render:e=>(0,a.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[!e.acknowledged&&a.jsx(h.zx,{size:"sm",variant:"ghost",onClick:()=>X(e.id),children:"Ack"}),!e.resolvedAt&&a.jsx(h.zx,{size:"sm",variant:"success",onClick:()=>ee(e.id),children:"Resolve"})]})}],data:K,emptyMessage:"No alerts"}):(0,a.jsxs)("div",{style:{padding:"60px",textAlign:"center"},children:[a.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"✅"}),a.jsx("h3",{style:{marginBottom:"8px"},children:"No alerts"}),a.jsx("p",{style:{color:"var(--color-text-muted)"},children:"All products are well-stocked!"})]})})},{id:"stats",label:"Statistics",icon:"\uD83D\uDCCA",content:(0,a.jsxs)("div",{style:{padding:"24px"},children:[a.jsx("h3",{style:{marginTop:0,marginBottom:"24px"},children:"Inventory Statistics"}),(0,a.jsxs)("div",{className:"grid grid-2",style:{marginBottom:"32px"},children:[(0,a.jsxs)(h.Zb,{children:[a.jsx(h.Ol,{title:"Stock Overview",icon:"\uD83D\uDCE6"}),a.jsx("div",{style:{padding:"16px"},children:(0,a.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[a.jsx("span",{children:"Total Stock"}),a.jsx("strong",{children:U})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[a.jsx("span",{children:"Available"}),a.jsx("strong",{style:{color:"var(--color-success)"},children:$})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[a.jsx("span",{children:"Reserved"}),a.jsx("strong",{style:{color:"var(--color-warning)"},children:Q})]})]})})]}),(0,a.jsxs)(h.Zb,{children:[a.jsx(h.Ol,{title:"Product Status",icon:"\uD83D\uDCCB"}),a.jsx("div",{style:{padding:"16px"},children:(0,a.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[a.jsx("span",{children:"In Stock"}),a.jsx(h.Ct,{variant:"success",children:R.filter(e=>"IN_STOCK"===e.status).length})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[a.jsx("span",{children:"Low Stock"}),a.jsx(h.Ct,{variant:"warning",children:H})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[a.jsx("span",{children:"Out of Stock"}),a.jsx(h.Ct,{variant:"error",children:V})]})]})})]})]}),a.jsx(h.bZ,{variant:"info",title:"Inventory Health",children:0===V&&0===H?"Your inventory is in good shape! All products are well-stocked.":(0,a.jsxs)(a.Fragment,{children:[V>0&&`${V} products are out of stock. `,H>0&&`${H} products are running low. `,"Consider restocking soon to avoid fulfillment delays."]})})]})}]})})})]})})]}),k&&S&&a.jsx(h.u_,{isOpen:k,onClose:()=>{f(!1),b(null),D(0),N("")},title:"Adjust Stock",size:"md",children:(0,a.jsxs)("div",{style:{padding:"24px"},children:[a.jsx("h4",{style:{marginTop:0,marginBottom:"16px"},children:S.productName}),(0,a.jsxs)("p",{style:{color:"var(--color-text-muted)",marginBottom:"24px"},children:["Current Stock: ",a.jsx("strong",{children:S.currentStock})]}),a.jsx(h.Ph,{label:"Adjustment Type",value:P,onChange:e=>A(e.target.value),options:[{value:"IN",label:"Stock In (Add)"},{value:"OUT",label:"Stock Out (Remove)"},{value:"ADJUSTMENT",label:"Adjustment (Correct)"}]}),a.jsx(h.II,{label:"Quantity",type:"number",value:I,onChange:e=>D(Number(e.target.value)),placeholder:"Enter quantity",hint:`New stock will be: ${S.currentStock+("OUT"===P?-I:I)}`}),a.jsx(h.II,{label:"Reason (Optional)",value:T,onChange:e=>N(e.target.value),placeholder:"e.g., Damaged, Returned, Restock..."}),(0,a.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"24px"},children:[a.jsx(h.zx,{onClick:G,disabled:O||0===I,fullWidth:!0,children:O?"Adjusting...":"Confirm Adjustment"}),a.jsx(h.zx,{onClick:()=>{f(!1),b(null)},variant:"ghost",fullWidth:!0,children:"Cancel"})]})]})}),C&&a.jsx(h.u_,{isOpen:C,onClose:()=>w(!1),title:"Add New Product",size:"lg",children:(0,a.jsxs)("div",{style:{padding:"24px"},children:[(0,a.jsxs)("div",{className:"grid grid-2",style:{gap:"16px"},children:[a.jsx(h.II,{label:"Shopee Item ID *",value:B.shopeeItemId,onChange:e=>z({...B,shopeeItemId:e.target.value}),placeholder:"e.g., 123456789"}),a.jsx(h.II,{label:"SKU *",value:B.sku,onChange:e=>z({...B,sku:e.target.value}),placeholder:"e.g., PROD-001"}),a.jsx(h.II,{label:"Product Name *",value:B.productName,onChange:e=>z({...B,productName:e.target.value}),placeholder:"Product name",style:{gridColumn:"1 / -1"}}),a.jsx(h.II,{label:"Initial Stock",type:"number",value:B.currentStock,onChange:e=>z({...B,currentStock:Number(e.target.value)})}),a.jsx(h.II,{label:"Low Stock Threshold",type:"number",value:B.lowStockThreshold,onChange:e=>z({...B,lowStockThreshold:Number(e.target.value)})}),a.jsx(h.II,{label:"Cost Price",type:"number",value:B.costPrice,onChange:e=>z({...B,costPrice:Number(e.target.value)})}),a.jsx(h.II,{label:"Selling Price",type:"number",value:B.sellingPrice,onChange:e=>z({...B,sellingPrice:Number(e.target.value)})}),a.jsx(h.II,{label:"Supplier",value:B.supplier,onChange:e=>z({...B,supplier:e.target.value}),placeholder:"Supplier name"}),a.jsx(h.II,{label:"Location",value:B.location,onChange:e=>z({...B,location:e.target.value}),placeholder:"e.g., Warehouse A"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"24px"},children:[a.jsx(h.zx,{onClick:J,disabled:O,fullWidth:!0,children:O?"Adding...":"Add Product"}),a.jsx(h.zx,{onClick:()=>w(!1),variant:"ghost",fullWidth:!0,children:"Cancel"})]})]})})]})}async function m({locale:e}){return{props:{...await (0,i.serverSideTranslations)(e,["common"])}}}l()}catch(e){l(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9816:e=>{e.exports=require("styled-jsx/style")},9648:e=>{e.exports=import("axios")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),l=t.X(0,[332,839,552,754,107,202,438],()=>r(8034));module.exports=l})();