"use strict";(()=>{var e={};e.id=750,e.ids=[750,660],e.modules={5326:(e,r,s)=>{s.a(e,async(e,t)=>{try{s.r(r),s.d(r,{config:()=>g,default:()=>u,getServerSideProps:()=>m,getStaticPaths:()=>x,getStaticProps:()=>h,reportWebVitals:()=>f,routeModule:()=>v,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>P,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>S,unstable_getStaticProps:()=>y});var a=s(8877),n=s(4591),i=s(6021),l=s(552),o=s.n(l),d=s(5270),c=s(4754),p=e([c]);c=(p.then?(await p)():p)[0];let u=(0,i.l)(c,"default"),h=(0,i.l)(c,"getStaticProps"),x=(0,i.l)(c,"getStaticPaths"),m=(0,i.l)(c,"getServerSideProps"),g=(0,i.l)(c,"config"),f=(0,i.l)(c,"reportWebVitals"),y=(0,i.l)(c,"unstable_getStaticProps"),S=(0,i.l)(c,"unstable_getStaticPaths"),j=(0,i.l)(c,"unstable_getStaticParams"),b=(0,i.l)(c,"unstable_getServerProps"),P=(0,i.l)(c,"unstable_getServerSideProps"),v=new a.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/orders/[id]",pathname:"/orders/[id]",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:c});t()}catch(e){t(e)}})},5697:(e,r,s)=>{s.d(r,{Z:()=>a});var t=s(997);function a({status:e,labels:r}){let s=e?.toUpperCase?.()||"",a="#cbd5e1",n="#0f172a",i=e;return["FULFILLED","PLACED"].includes(s)?(a="#dcfce7",n="#166534",i=r.success):["FAILED","SKIPPED"].includes(s)?(a="#fee2e2",n="#991b1b",i=r.error):["QUEUED","PROCESSING","UNPROCESSED"].includes(s)?(a="#e0f2fe",n="#075985",i=r.pending):["MANUAL_REVIEW"].includes(s)&&(a="#e2e8f0",n="#0f172a",i=r.manual),t.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:600,background:a,color:n},children:i})}},4754:(e,r,s)=>{s.a(e,async(e,t)=>{try{s.r(r),s.d(r,{default:()=>f,getServerSideProps:()=>S});var a=s(997),n=s(5460),i=s(1377),l=s(6555),o=s(1522),d=s(9097),c=s.n(d),p=s(5632),u=s(5941),h=s(6689),x=s(7029),m=s(5697),g=e([o,u]);[o,u]=g.then?(await g)():g;let y=e=>o.Z.get(e).then(e=>e.data);function f(){let{t:e}=(0,i.useTranslation)("common"),{id:r}=(0,p.useRouter)().query,{data:s,mutate:t}=(0,u.default)(r?`/api/orders/${r}`:null,y),[n,d]=(0,h.useState)(""),[g,f]=(0,h.useState)(!1),[S,j]=(0,h.useState)(!1),b=(0,h.useMemo)(()=>s?.rawPayload?.amazonProductUrl||s?.errorItems?.[0]?.amazonProductUrl||null,[s]);return s?(0,a.jsxs)("div",{className:"container",children:[a.jsx(l.Z,{activeHref:"/orders"}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("h1",{children:[e("orders")," ",s.shopeeOrderSn]}),(0,a.jsxs)("p",{children:[e("shop"),": ",s.shop?.name??"—"]}),(0,a.jsxs)("p",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[e("ordersTableStatus"),":"," ",a.jsx(m.Z,{status:s.processingStatus,labels:{success:e("statusProcessed"),error:e("statusError"),pending:e("statusPending"),manual:e("ordersTableManual")}})," ",s.processingMode?(0,a.jsxs)("span",{style:{color:"#475569"},children:["(",s.processingMode,")"]}):null]}),(0,a.jsxs)("p",{children:[e("total"),": ",s.orderTotal??"—"," ",s.currency]}),(0,a.jsxs)("p",{children:[e("profit"),": ",s.expectedProfit??"—"," ",s.expectedProfitCurrency??s.currency]}),(0,a.jsxs)("p",{children:[e("shippingDaysLabel")??"Shipping days",": ",s.shippingDays??"—"]}),(0,a.jsxs)("p",{children:[e("amazon"),":"," ",b?a.jsx("a",{href:b,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:b}):"—"]}),s.amazonOrder&&(0,a.jsxs)("div",{className:"card",style:{marginTop:12},children:[a.jsx("h4",{children:e("amazonOrderId")}),(0,a.jsxs)("p",{children:[s.amazonOrder.amazonOrderId??e("statusPending")," (",s.amazonOrder.status,")"]}),(0,a.jsxs)("p",{children:[e("total"),": ",s.amazonOrder.purchasePrice??"—"]}),s.amazonOrder.placedAt&&(0,a.jsxs)("p",{children:[e("createdAt"),": ",new Date(s.amazonOrder.placedAt).toLocaleString()]})]}),s.errorItems?.length>0&&(0,a.jsxs)("div",{className:"card",style:{marginTop:12},children:[a.jsx("h4",{children:e("error")}),a.jsx("ul",{children:s.errorItems.map(r=>(0,a.jsxs)("li",{style:{marginBottom:8},children:[a.jsx("div",{children:r.reason||r.errorCode}),(0,a.jsxs)("div",{style:{color:"#475569",fontSize:12},children:[r.errorCode," ",r.filterFailureType?`• ${r.filterFailureType}`:"",null!==r.profitValue&&void 0!==r.profitValue?` • profit=${r.profitValue}`:"",null!==r.shippingDays&&void 0!==r.shippingDays?` • days=${r.shippingDays}`:""]}),a.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:new Date(r.createdAt).toLocaleString()}),r.metadata?.screenshot&&a.jsx("div",{children:a.jsx("a",{href:r.metadata.screenshot,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:e("openLink")})})]},r.id))})]}),(0,a.jsxs)("div",{className:"card",style:{marginTop:12},children:[a.jsx("h4",{children:e("manualActions")}),a.jsx("textarea",{className:"input",style:{minHeight:80},placeholder:e("manualNote"),value:n,onChange:e=>d(e.target.value)}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"btn btn-ghost",onClick:async()=>{f(!0);try{await o.Z.post(`/api/orders/retry/${s.id}`),(0,x.M)(e("retrySuccess")),t()}catch(r){(0,x.M)(r?.response?.data?.error??e("actionRetryError"),"error")}finally{f(!1)}},disabled:g,children:g?e("loading"):e("retry")}),a.jsx("button",{className:"btn btn-ghost",onClick:async()=>{j(!0);try{await o.Z.post(`/api/orders/manual/${s.id}`,{manualNote:n}),d(""),(0,x.M)(e("actionManualFulfillSuccess")),t()}catch(r){(0,x.M)(r?.response?.data?.error??e("actionManualFulfillError"),"error")}finally{j(!1)}},disabled:S,children:S?e("loading"):e("manualFulfill")}),a.jsx(c(),{className:"btn btn-ghost",href:"/orders",children:e("back")})]})]})]})]}):(0,a.jsxs)("div",{className:"container",children:[a.jsx(l.Z,{activeHref:"/orders"}),a.jsx("p",{children:e("loading")})]})}let S=async({locale:e})=>({props:{...await (0,n.serverSideTranslations)(e||"en",["common"])}});t()}catch(e){t(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9816:e=>{e.exports=require("styled-jsx/style")},9648:e=>{e.exports=import("axios")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[332,839,552,754,107],()=>s(5326));module.exports=t})();