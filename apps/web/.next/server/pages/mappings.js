"use strict";(()=>{var e={};e.id=679,e.ids=[679,660],e.modules={1752:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>g,default:()=>u,getServerSideProps:()=>x,getStaticPaths:()=>m,getStaticProps:()=>h,reportWebVitals:()=>j,routeModule:()=>y,unstable_getServerProps:()=>P,unstable_getServerSideProps:()=>f,unstable_getStaticParams:()=>b,unstable_getStaticPaths:()=>S,unstable_getStaticProps:()=>v});var r=a(8877),l=a(4591),i=a(6021),n=a(552),o=a.n(n),c=a(5270),d=a(760),p=e([d]);d=(p.then?(await p)():p)[0];let u=(0,i.l)(d,"default"),h=(0,i.l)(d,"getStaticProps"),m=(0,i.l)(d,"getStaticPaths"),x=(0,i.l)(d,"getServerSideProps"),g=(0,i.l)(d,"config"),j=(0,i.l)(d,"reportWebVitals"),v=(0,i.l)(d,"unstable_getStaticProps"),S=(0,i.l)(d,"unstable_getStaticPaths"),b=(0,i.l)(d,"unstable_getStaticParams"),P=(0,i.l)(d,"unstable_getServerProps"),f=(0,i.l)(d,"unstable_getServerSideProps"),y=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/mappings",pathname:"/mappings",bundlePath:"",filename:""},components:{App:c.default,Document:o()},userland:d});s()}catch(e){s(e)}})},760:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>u,getStaticProps:()=>h});var r=a(997),l=a(6689),i=a(5460),n=a(1377),o=a(2684),c=a(1522),d=a(7029),p=e([c]);function u(){let{t:e}=(0,n.useTranslation)("common"),[t,a]=(0,l.useState)([]),[s,i]=(0,l.useState)([]),[p,u]=(0,l.useState)(""),[h,m]=(0,l.useState)(""),[x,g]=(0,l.useState)(""),[j,v]=(0,l.useState)(""),[S,b]=(0,l.useState)(""),[P,f]=(0,l.useState)(""),[y,N]=(0,l.useState)(""),[C,I]=(0,l.useState)(!1),[q,w]=(0,l.useState)(!1),[M,_]=(0,l.useState)(!1),z=async()=>{I(!0);try{let[e,t]=await Promise.all([c.Z.get("/api/shops"),c.Z.get("/api/mappings")]);i(e.data||[]),a(t.data||[])}catch(t){(0,d.M)(t?.response?.data?.error??e("genericError"),"error")}finally{I(!1)}};(0,l.useEffect)(()=>{z()},[]);let k=async()=>{if(b(""),!p||!h||!x){(0,d.M)(e("fieldRequired"),"error");return}w(!0);try{await c.Z.post("/api/mappings",{shopId:p,shopeeItemId:h,amazonProductUrl:x,notes:j||void 0}),u(""),m(""),g(""),v(""),b(e("mappingSaved")),(0,d.M)(e("mappingSaved")),z()}catch(t){(0,d.M)(t?.response?.data?.error??e("genericError"),"error")}finally{w(!1)}},B=(0,l.useMemo)(()=>t.filter(e=>{let t=s.find(t=>t.id===e.shopId)?.name||"",a=P.toLowerCase();return e.shopeeItemId.toLowerCase().includes(a)||e.amazonProductUrl.toLowerCase().includes(a)||t.toLowerCase().includes(a)}),[P,t,s]);return(0,r.jsxs)("div",{className:"container",children:[r.jsx(o.Z,{activeHref:"/mappings"}),(0,r.jsxs)("div",{className:"card",children:[r.jsx("h1",{children:e("mappingsTitle")}),r.jsx("p",{style:{color:"#475569"},children:e("mappingsDescFull")}),(0,r.jsxs)("div",{className:"grid grid-3",style:{marginBottom:16},children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"label",children:e("shopSelection")}),(0,r.jsxs)("select",{className:"select",value:p,onChange:e=>u(e.target.value),children:[r.jsx("option",{value:"",children:e("selectPlaceholder")}),s.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"label",children:e("shopeeItemId")}),r.jsx("input",{className:"input",value:h,onChange:e=>m(e.target.value)})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"label",children:e("amazonProduct")}),r.jsx("input",{className:"input",value:x,onChange:e=>g(e.target.value)})]})]}),(0,r.jsxs)("div",{className:"grid grid-1",style:{marginBottom:12},children:[r.jsx("label",{className:"label",children:e("notes")||"Notes"}),r.jsx("textarea",{className:"input",value:j,onChange:e=>v(e.target.value)})]}),r.jsx("button",{className:"btn",onClick:k,disabled:q,children:q?e("loading"):e("saveMappingBtn")}),S&&r.jsx("p",{children:S})]}),(0,r.jsxs)("div",{className:"card",children:[r.jsx("h3",{children:e("mappingsTitle")}),C&&r.jsx("p",{children:e("loading")}),r.jsx("input",{className:"input",placeholder:e("searchMappings")||"Search mappings...",style:{maxWidth:300},value:P,onChange:e=>f(e.target.value)}),0!==B.length||C?r.jsx("div",{className:"table-responsive",children:(0,r.jsxs)("table",{className:"table",style:{minWidth:720},children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:e("shopSelection")}),r.jsx("th",{children:e("shopeeProduct")}),r.jsx("th",{children:e("amazonProduct")}),r.jsx("th",{children:e("status")||"Status"})]})}),r.jsx("tbody",{children:B.map(t=>(0,r.jsxs)("tr",{children:[r.jsx("td",{children:s.find(e=>e.id===t.shopId)?.name??t.shopId}),r.jsx("td",{children:t.shopeeItemId}),(0,r.jsxs)("td",{children:[r.jsx("a",{href:t.amazonProductUrl,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:t.amazonProductUrl}),t.notes?r.jsx("div",{style:{color:"#475569",fontSize:12},children:t.notes}):null]}),r.jsx("td",{children:t.isActive?e("on"):e("off")})]},t.id))})]})}):r.jsx("p",{children:e("noMappings")??"No mappings yet."})]}),(0,r.jsxs)("div",{className:"card",children:[r.jsx("h3",{children:e("bulkImportHint")}),r.jsx("textarea",{className:"input",style:{minHeight:120},placeholder:e("csvPlaceholder"),value:y,onChange:e=>N(e.target.value)}),r.jsx("button",{className:"btn btn-ghost",onClick:async()=>{_(!0);try{let t=y.split("\n").map(e=>e.trim()).filter(Boolean).map(e=>{let[t,a,s,r]=e.split(",");return{shopId:t,shopeeItemId:a,amazonProductUrl:s,notes:r}});await c.Z.post("/api/mappings/import",{rows:t}),N(""),z(),(0,d.M)(e("mappingSaved"))}catch(t){(0,d.M)(t?.response?.data?.error??e("genericError"),"error")}finally{_(!1)}},disabled:M,children:M?e("loading"):e("importCsvBtn")})]})]})}async function h({locale:e}){return{props:{...await (0,i.serverSideTranslations)(e,["common"])}}}c=(p.then?(await p)():p)[0],s()}catch(e){s(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[332,839,552,754,52],()=>a(1752));module.exports=s})();