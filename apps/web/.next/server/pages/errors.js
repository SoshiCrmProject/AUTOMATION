"use strict";(()=>{var e={};e.id=298,e.ids=[298,660],e.modules={8954:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{config:()=>m,default:()=>u,getServerSideProps:()=>g,getStaticPaths:()=>x,getStaticProps:()=>h,reportWebVitals:()=>y,routeModule:()=>P,unstable_getServerProps:()=>S,unstable_getServerSideProps:()=>v,unstable_getStaticParams:()=>b,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>f});var a=t(8877),l=t(4591),n=t(6021),o=t(552),i=t.n(o),d=t(4076),c=t(3356),p=e([c]);c=(p.then?(await p)():p)[0];let u=(0,n.l)(c,"default"),h=(0,n.l)(c,"getStaticProps"),x=(0,n.l)(c,"getStaticPaths"),g=(0,n.l)(c,"getServerSideProps"),m=(0,n.l)(c,"config"),y=(0,n.l)(c,"reportWebVitals"),f=(0,n.l)(c,"unstable_getStaticProps"),j=(0,n.l)(c,"unstable_getStaticPaths"),b=(0,n.l)(c,"unstable_getStaticParams"),S=(0,n.l)(c,"unstable_getServerProps"),v=(0,n.l)(c,"unstable_getServerSideProps"),P=new a.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/errors",pathname:"/errors",bundlePath:"",filename:""},components:{App:d.default,Document:i()},userland:c});s()}catch(e){s(e)}})},8335:(e,r,t)=>{t.d(r,{Z:()=>l});var s=t(997),a=t(1377);function l({items:e,selectable:r,selected:t,onToggle:l}){let{t:n}=(0,a.useTranslation)("common");return e.length?(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[r&&s.jsx("th",{}),s.jsx("th",{style:{textAlign:"left"},children:n("orders")}),s.jsx("th",{style:{textAlign:"left"},children:n("reason")}),s.jsx("th",{style:{textAlign:"left"},children:n("amazon")}),s.jsx("th",{style:{textAlign:"left"},children:n("createdAt")})]})}),s.jsx("tbody",{children:e.map(e=>{let a=e.shopeeOrderId??e.id,o=t?.has(a)??!1;return(0,s.jsxs)("tr",{children:[r&&s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:o,onChange:()=>l?.(e.id,e.shopeeOrderId??void 0)})}),s.jsx("td",{style:{padding:"6px 4px"},children:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[s.jsx("strong",{children:e.shopeeOrderId??a}),e.amazonProductUrl?s.jsx("a",{href:e.amazonProductUrl,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:n("amazonPage")}):null]})}),s.jsx("td",{children:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[s.jsx("span",{children:e.reason||e.errorCode}),e.errorCode&&s.jsx("span",{style:{color:"#475569",fontSize:12},children:e.errorCode}),e.filterFailureType&&s.jsx("span",{style:{color:"#475569",fontSize:12},children:e.filterFailureType}),null!==e.profitValue&&void 0!==e.profitValue&&(0,s.jsxs)("span",{style:{color:"#475569",fontSize:12},children:[n("minProfit"),": ",e.profitValue]}),null!==e.shippingDays&&void 0!==e.shippingDays&&(0,s.jsxs)("span",{style:{color:"#475569",fontSize:12},children:[n("shippingDaysLabel")??"Shipping days",": ",e.shippingDays]}),e.metadata?.screenshot&&s.jsx("a",{href:e.metadata.screenshot,target:"_blank",rel:"noreferrer",style:{color:"#2563eb",fontSize:12},children:n("openLink")})]})}),s.jsx("td",{children:e.amazonProductUrl?s.jsx("a",{href:e.amazonProductUrl,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:n("amazonPage")}):"—"}),s.jsx("td",{children:new Date(e.createdAt).toLocaleString()})]},e.id)})})]}):s.jsx("p",{children:n("noErrors")})}},3356:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{default:()=>x,getStaticProps:()=>g});var a=t(997),l=t(5941),n=t(5460),o=t(1377),i=t(6555),d=t(8335),c=t(6689),p=t(1522),u=t(7029),h=e([l,p]);[l,p]=h.then?(await h)():h;let m=e=>p.Z.get(e).then(e=>e.data);function x(){let{t:e}=(0,o.useTranslation)("common"),{data:r,error:t}=(0,l.default)("/api/orders/errors",m,{revalidateOnFocus:!1}),[s,n]=(0,c.useState)(""),[h,x]=(0,c.useState)(new Set),[g,y]=(0,c.useState)(!1),[f,j]=(0,c.useState)(!1),[b,S]=(0,c.useState)("desc"),v=async()=>{y(!0);try{let r=await p.Z.get("/api/orders/errors/export",{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([r.data])),s=document.createElement("a");s.href=t,s.setAttribute("download",e("errorItemsFile")),document.body.appendChild(s),s.click()}catch(r){(0,u.M)(r?.response?.data?.error??e("downloadError"),"error")}finally{y(!1)}},P=async()=>{j(!0);try{await Promise.all(Array.from(h).map(e=>p.Z.post(`/api/orders/retry/${e}`))),x(new Set),(0,u.M)(e("actionRetrySelectedSuccess"))}catch(r){(0,u.M)(r?.response?.data?.error??e("actionRetrySelectedError"),"error")}finally{j(!1)}},w=(0,c.useMemo)(()=>(r??[]).filter(e=>{let r=s.toLowerCase();return(e.reason??"").toLowerCase().includes(r)||(e.errorCode??"").toLowerCase().includes(r)||(e.amazonProductUrl??"").toLowerCase().includes(r)||(e.shopeeOrderId??"").toLowerCase().includes(r)}).sort((e,r)=>{let t=new Date(e.createdAt).getTime(),s=new Date(r.createdAt).getTime();return"asc"===b?t-s:s-t}),[r,s,b]);return(0,a.jsxs)("div",{className:"container",children:[a.jsx(i.Z,{activeHref:"/errors"}),a.jsx("h1",{children:e("errorFile")}),a.jsx("p",{children:e("errorFileDesc")}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{className:"btn btn-ghost",onClick:v,disabled:g,children:g?e("loading"):e("openFile")}),h.size>0&&a.jsx("button",{className:"btn",onClick:P,disabled:f,children:f?e("loading"):e("retrySelectedLabel",{count:h.size})})]}),(0,a.jsxs)("div",{className:"card",style:{marginTop:"16px"},children:[a.jsx("input",{className:"input",placeholder:e("search")||"Search",style:{maxWidth:300},value:s,onChange:e=>n(e.target.value)}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:8,alignItems:"center"},children:(0,a.jsxs)("button",{className:"btn btn-ghost",onClick:()=>S(e=>"asc"===e?"desc":"asc"),children:[e("createdAt")," ","asc"===b?"↑":"↓"]})}),!r&&!t&&a.jsx("p",{children:e("loading")}),t&&a.jsx("p",{style:{color:"#ef4444"},children:e("genericError")}),r&&a.jsx("div",{className:"table-responsive",children:a.jsx(d.Z,{selectable:!0,selected:h,onToggle:(e,r)=>{let t=r??e,s=new Set(h);s.has(t)?s.delete(t):s.add(t),x(s)},items:w})})]})]})}async function g({locale:e}){return{props:{...await (0,n.serverSideTranslations)(e,["common"])}}}s()}catch(e){s(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9816:e=>{e.exports=require("styled-jsx/style")},9648:e=>{e.exports=import("axios")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var r=require("../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[332,839,552,754,638,555],()=>t(8954));module.exports=s})();