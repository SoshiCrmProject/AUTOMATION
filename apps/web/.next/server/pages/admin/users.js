"use strict";(()=>{var e={};e.id=635,e.ids=[635,660],e.modules={8473:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>g,default:()=>p,getServerSideProps:()=>x,getStaticPaths:()=>m,getStaticProps:()=>h,reportWebVitals:()=>v,routeModule:()=>w,unstable_getServerProps:()=>S,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>f});var s=a(8877),i=a(4591),n=a(6021),l=a(552),o=a.n(l),d=a(4076),c=a(3516),u=e([c]);c=(u.then?(await u)():u)[0];let p=(0,n.l)(c,"default"),h=(0,n.l)(c,"getStaticProps"),m=(0,n.l)(c,"getStaticPaths"),x=(0,n.l)(c,"getServerSideProps"),g=(0,n.l)(c,"config"),v=(0,n.l)(c,"reportWebVitals"),f=(0,n.l)(c,"unstable_getStaticProps"),j=(0,n.l)(c,"unstable_getStaticPaths"),y=(0,n.l)(c,"unstable_getStaticParams"),S=(0,n.l)(c,"unstable_getServerProps"),b=(0,n.l)(c,"unstable_getServerSideProps"),w=new s.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/admin/users",pathname:"/admin/users",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:c});r()}catch(e){r(e)}})},1522:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{Z:()=>l});var s=a(9648),i=e([s]);let n=(s=(i.then?(await i)():i)[0]).default.create({baseURL:"https://automation-api-tau.vercel.app"});n.defaults.adapter,n.interceptors.request.use(e=>{let t=e.url||"";if(t.startsWith("/api/orders/"))e.url=t.replace("/api","");else for(let a of["/api/settings","/api/credentials/","/api/shops","/api/admin/","/api/ops/","/api/auth/","/api/mappings","/api/products/","/api/profit/"])if(t.startsWith(a)){e.url=t.replace("/api","");break}return e}),n.interceptors.response.use(e=>e,e=>(e.response?.status,Promise.reject(e)));let l=n;r()}catch(e){r(e)}})},3516:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>h,getStaticProps:()=>m});var s=a(997),i=a(6689),n=a(5460),l=a(1377),o=a(5681),d=a(1522),c=a(7029),u=a(3877),p=e([d]);function h(){let{t:e}=(0,l.useTranslation)("common"),[t,a]=(0,i.useState)([]),[r,n]=(0,i.useState)(""),[p,h]=(0,i.useState)(!1),[m,x]=(0,i.useState)(new Set),[g,v]=(0,i.useState)(new Set),[f,j]=(0,i.useState)(""),[y,S]=(0,i.useState)("all"),b=async()=>{h(!0);try{let e=await d.Z.get("/api/admin/users");a(e.data)}catch(t){(0,c.M)(t?.response?.data?.error??e("genericError"),"error")}finally{h(!1)}};(0,i.useEffect)(()=>{b()},[]);let w=async t=>{x(e=>new Set(e).add(t));try{await d.Z.post(`/api/admin/users/${t}/toggle`),(0,c.M)(e("adminToggleSuccess")),b()}catch(t){(0,c.M)(t?.response?.data?.error??e("adminToggleError"),"error")}finally{x(e=>{let a=new Set(e);return a.delete(t),a})}},D=async t=>{if(r){v(e=>new Set(e).add(t));try{await d.Z.post(`/api/admin/users/${t}/reset-password`,{password:r}),n(""),(0,c.M)(e("passwordReset"))}catch(t){(0,c.M)(t?.response?.data?.error??e("adminResetError"),"error")}finally{v(e=>{let a=new Set(e);return a.delete(t),a})}}},C=t.length,P=t.filter(e=>e.isActive).length,k=t.filter(e=>"admin"===e.role).length,T=Array.from(new Set(t.map(e=>e.role))),z=(0,i.useMemo)(()=>t.filter(e=>{let t="all"===y||e.role===y,a=e.email.toLowerCase().includes(f.toLowerCase());return t&&a}),[t,y,f]),A=s.jsx("div",{style:{display:"grid",gap:16,gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))"},children:[{label:e("totalUsers")||"Total users",value:C,helper:e("adminTotalHint")||"Provisioned seats"},{label:e("active")||"Active",value:P,helper:e("adminActiveHint")||"Enabled accounts"},{label:e("admins")||"Admins",value:k,helper:e("adminRoleHint")||"Full-access owners"}].map(e=>(0,s.jsxs)("div",{className:"stat-card",style:{padding:20},children:[s.jsx("p",{style:{fontSize:12,textTransform:"uppercase",letterSpacing:1,color:"var(--color-text-light)",marginBottom:6},children:e.label}),s.jsx("div",{style:{fontSize:28,fontWeight:800},children:e.value}),s.jsx("p",{style:{margin:0,color:"var(--color-text-muted)",fontSize:13},children:e.helper})]},e.label))}),q=(0,s.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center"},children:[s.jsx(u.II,{placeholder:e("searchUsers")||"Search by email",value:f,onChange:e=>j(e.target.value),style:{marginBottom:0,minWidth:220},icon:s.jsx("span",{role:"img","aria-hidden":"true",children:"\uD83D\uDD0E"})}),s.jsx(u.Ph,{value:y,onChange:e=>S(e.target.value),options:[{value:"all",label:e("allRoles")||"All roles"},...T.map(e=>({value:e,label:e}))],style:{marginBottom:0,minWidth:180}}),s.jsx(u.zx,{type:"button",variant:"ghost",onClick:b,children:e("refreshData")||"Refresh"})]}),W=s.jsx("div",{children:(0,s.jsxs)(u.Zb,{hover:!1,children:[s.jsx(u.Ol,{title:e("adminQuickActions")||"Quick actions",icon:"⚡"}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[s.jsx(u.zx,{type:"button",variant:"ghost",onClick:()=>window.open("mailto:support@automation","_blank"),children:e("contactSupport")||"Contact support"}),(0,s.jsxs)(u.zx,{type:"button",variant:"ghost",onClick:()=>window.location.href="/admin/audit",children:["\uD83D\uDCDD ",e("adminAuditTitle")]}),s.jsx(u.zx,{type:"button",onClick:()=>window.open("https://status.autoship","_blank"),children:"\uD83D\uDCE1 Status page"})]})]})}),_=(0,s.jsxs)(u.Ct,{variant:P===C?"success":"warning",children:[P,"/",C," ",e("active")||"active"]}),E=(0,s.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[(0,s.jsxs)(u.zx,{type:"button",onClick:()=>window.open("mailto:hr@automation"),children:["➕ ",e("inviteUser")||"Invite user"]}),(0,s.jsxs)(u.zx,{type:"button",variant:"ghost",onClick:b,children:["\uD83D\uDD04 ",e("syncDirectory")||"Sync directory"]})]});return s.jsx(o.Z,{activeHref:"/admin/users",title:e("adminUsersTitle"),description:e("adminUsersDesc")||"Manage privileged users, reset access, and monitor workspace controls.",heroBadge:_,heroAside:A,actions:E,toolbar:q,sidebar:W,heroFooter:s.jsx("span",{style:{color:"var(--color-text-muted)",fontSize:14},children:e("adminHeroFooter")||"SCIM sync runs every hour. Use the quick actions to force refresh."}),children:(0,s.jsxs)(u.Zb,{hover:!1,children:[s.jsx(u.Ol,{title:e("adminTableTitle")||"Workspace directory",subtitle:e("adminTableSubtitle")||"Toggle access, reset passwords, and audit roles.",icon:"\uD83D\uDC65",action:(0,s.jsxs)(u.Ct,{variant:"info",children:[z.length," ",e("visible")||"visible"]})}),p&&s.jsx(u.TK,{text:e("loading")||"Loading"}),!p&&0===z.length&&s.jsx(u.ub,{icon:"\uD83E\uDDD0",title:e("noUsersFound")||"No users match your filters",description:e("adjustFilters")||"Try clearing the search or selecting another role.",action:s.jsx(u.zx,{type:"button",variant:"ghost",onClick:()=>{j(""),S("all")},children:e("resetFilters")||"Reset filters"})}),!p&&z.length>0&&s.jsx("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"table",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:e("adminEmail")}),s.jsx("th",{children:e("adminRole")}),s.jsx("th",{children:e("adminStatus")}),s.jsx("th",{children:e("adminCreated")||"Created"}),s.jsx("th",{children:e("adminActions")})]})}),s.jsx("tbody",{children:z.map(t=>(0,s.jsxs)("tr",{children:[s.jsx("td",{children:t.email}),s.jsx("td",{children:s.jsx(u.Ct,{variant:"admin"===t.role?"warning":"default",children:t.role})}),s.jsx("td",{children:s.jsx(u.Ct,{variant:t.isActive?"success":"error",children:t.isActive?e("active"):e("inactive")})}),s.jsx("td",{children:new Date(t.createdAt).toLocaleDateString()}),(0,s.jsxs)("td",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[s.jsx(u.zx,{size:"sm",variant:"ghost",onClick:()=>w(t.id),loading:m.has(t.id),children:t.isActive?e("deactivate"):e("activate")}),s.jsx(u.II,{type:"password",placeholder:e("newPassword")||"Temp password",value:r,onChange:e=>n(e.target.value),style:{marginBottom:0},fullWidth:!1}),s.jsx(u.zx,{size:"sm",onClick:()=>D(t.id),loading:g.has(t.id),disabled:!r,children:e("reset")})]})]},t.id))})]})})]})})}async function m({locale:e}){return{props:{...await (0,n.serverSideTranslations)(e,["common"])}}}d=(p.then?(await p)():p)[0],r()}catch(e){r(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[332,839,552,754,20],()=>a(8473));module.exports=r})();