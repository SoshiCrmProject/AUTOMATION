"use strict";(()=>{var e={};e.id=756,e.ids=[756,660],e.modules={1057:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>h,default:()=>p,getServerSideProps:()=>m,getStaticPaths:()=>g,getStaticProps:()=>x,reportWebVitals:()=>v,routeModule:()=>D,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>b,unstable_getStaticPaths:()=>f,unstable_getStaticProps:()=>y});var s=a(8877),l=a(4591),i=a(6021),n=a(552),o=a.n(n),c=a(4076),d=a(5153),u=e([d]);d=(u.then?(await u)():u)[0];let p=(0,i.l)(d,"default"),x=(0,i.l)(d,"getStaticProps"),g=(0,i.l)(d,"getStaticPaths"),m=(0,i.l)(d,"getServerSideProps"),h=(0,i.l)(d,"config"),v=(0,i.l)(d,"reportWebVitals"),y=(0,i.l)(d,"unstable_getStaticProps"),f=(0,i.l)(d,"unstable_getStaticPaths"),b=(0,i.l)(d,"unstable_getStaticParams"),j=(0,i.l)(d,"unstable_getServerProps"),S=(0,i.l)(d,"unstable_getServerSideProps"),D=new s.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/ops",pathname:"/ops",bundlePath:"",filename:""},components:{App:c.default,Document:o()},userland:d});r()}catch(e){r(e)}})},5697:(e,t,a)=>{a.d(t,{Z:()=>s});var r=a(997);function s({status:e,labels:t}){let a=e?.toUpperCase?.()||"",s="#cbd5e1",l="#0f172a",i=e;return["FULFILLED","PLACED"].includes(a)?(s="#dcfce7",l="#166534",i=t.success):["FAILED","SKIPPED"].includes(a)?(s="#fee2e2",l="#991b1b",i=t.error):["QUEUED","PROCESSING","UNPROCESSED"].includes(a)?(s="#e0f2fe",l="#075985",i=t.pending):["MANUAL_REVIEW"].includes(a)&&(s="#e2e8f0",l="#0f172a",i=t.manual),r.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:600,background:s,color:l},children:i})}},1522:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{Z:()=>n});var s=a(9648),l=e([s]);let i=(s=(l.then?(await l)():l)[0]).default.create({baseURL:"https://automation-api-tau.vercel.app"});i.defaults.adapter,i.interceptors.request.use(e=>{let t=e.url||"";if(t.startsWith("/api/orders/"))e.url=t.replace("/api","");else for(let a of["/api/settings","/api/credentials/","/api/shops","/api/admin/","/api/ops/","/api/auth/","/api/mappings","/api/products/","/api/profit/"])if(t.startsWith(a)){e.url=t.replace("/api","");break}return e}),i.interceptors.response.use(e=>e,e=>(e.response?.status,Promise.reject(e)));let n=i;r()}catch(e){r(e)}})},5153:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>x,getStaticProps:()=>g});var s=a(997),l=a(6689),i=a(5460),n=a(1377),o=a(5681),c=a(5697),d=a(1522),u=a(3877),p=e([d]);function x(){let{t:e}=(0,n.useTranslation)("common"),[t,a]=(0,l.useState)(null),[r,i]=(0,l.useState)(null),[p,x]=(0,l.useState)(""),[g,m]=(0,l.useState)(!1),[h,v]=(0,l.useState)(!1),[y,f]=(0,l.useState)(null),[b,j]=(0,l.useState)(null),S=async()=>{m(!0);try{let[e,t,r]=await Promise.allSettled([d.Z.get("/api/ops/queue"),d.Z.get("/api/ops/status"),d.Z.get("/health")]);"fulfilled"===e.status&&a(e.value.data),"fulfilled"===t.status&&i(t.value.data),"fulfilled"===r.status&&f(r.value.data)}catch(t){j({type:"error",text:t?.response?.data?.error??(e("genericError")||"Something went wrong")})}finally{m(!1)}};(0,l.useEffect)(()=>{S()},[]);let D=async()=>{j(null);let t=p.trim();if(!t||!/amazon\./i.test(t)){j({type:"warning",text:e("pleaseEnterValidAmazonURL")||"Enter a valid Amazon URL"});return}v(!0);try{let a=await d.Z.post("/api/ops/amazon-scrape",{productUrl:t}),r=a.data?.result,s=r?`${e("testScrapeQueued")||"Amazon scrape queued"} \xb7 \xa5${r.price.toLocaleString()}`:e("testScrapeQueued")||"Amazon scrape queued";j({type:"success",text:s})}catch(r){let t=r?.response?.data?.code,a=r?.response?.data?.error??(e("genericError")||"Unable to queue test");j({type:"error",text:t?`${t}: ${a}`:a})}finally{v(!1)}},w=[{key:"waiting",label:e("waiting")||"Waiting",value:t?.waiting??"—",helper:e("queueWaitingHelper")||"Jobs queued"},{key:"active",label:e("active")||"Active",value:t?.active??"—",helper:e("queueActiveHelper")||"Currently processing"},{key:"failed",label:e("failed")||"Failed",value:t?.failed??"—",helper:e("queueFailedHelper")||"Need attention"},{key:"delayed",label:e("delayed")||"Delayed",value:t?.delayed??"—",helper:e("queueDelayedHelper")||"Scheduled retries"}],E=s.jsx("div",{className:"grid grid-2",style:{width:"100%"},children:w.map(e=>(0,s.jsxs)("div",{style:{border:"1px solid var(--color-border)",borderRadius:"var(--radius-lg)",padding:"16px",background:"rgba(255,255,255,0.7)",minHeight:100},children:[s.jsx("p",{className:"label",style:{marginBottom:6},children:e.label}),s.jsx("div",{style:{fontSize:28,fontWeight:800},children:e.value}),s.jsx("p",{style:{margin:0,color:"var(--color-text-muted)",fontSize:13},children:e.helper})]},e.key))}),L=(0,s.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:16,alignItems:"center",width:"100%"},children:[s.jsx(u.zx,{type:"button",onClick:S,loading:g,children:e("refreshData")||"Refresh metrics"}),(0,s.jsxs)(u.Ct,{variant:y?"success":"warning",children:[(e("lastPing")||"Last ping")+": ",y?.timestamp?new Date(y.timestamp).toLocaleTimeString():e("noRecentData")||"N/A"]})]}),P=s.jsx("div",{children:(0,s.jsxs)(u.Zb,{hover:!1,children:[s.jsx(u.Ol,{title:e("opsGuardrail")||"Ops guardrails",icon:"\uD83D\uDEE1️"}),(0,s.jsxs)("ul",{style:{paddingLeft:18,margin:0,color:"var(--color-text-muted)",lineHeight:1.6,fontSize:14},children:[s.jsx("li",{children:e("opsGuardrailWorkflows")||"Pause syncs if failed jobs spike above 50."}),s.jsx("li",{children:e("opsGuardrailEscalate")||"Escalate to engineering if heartbeat fails twice."}),s.jsx("li",{children:e("opsGuardrailDocs")||"Log every manual test in your on-call doc."})]})]})}),z=s.jsx(u.Ct,{variant:y?"success":"error",children:y?e("systemOperational")||"Systems nominal":e("systemIssuesDetected")||"Issues detected"}),A=(0,s.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[s.jsx(u.zx,{type:"button",onClick:S,loading:g,children:e("refreshData")||"Refresh"}),s.jsx(u.zx,{type:"button",variant:"ghost",onClick:()=>{},children:e("contactOps")||"Contact ops"})]}),q=[{label:e("lastOrderLabel")||"Last Shopee order",value:r?.lastOrder?new Date(r.lastOrder).toLocaleString():e("none")||"None"},{label:e("lastAmazonLabel")||"Last Amazon action",value:r?.lastAmazon?`${new Date(r.lastAmazon.createdAt).toLocaleString()} (${r.lastAmazon.status})`:e("none")||"None"},{label:e("lastErrorLabel")||"Last error",value:r?.lastError?`${new Date(r.lastError.createdAt).toLocaleString()} - ${r.lastError.reason}`:e("none")||"None"}],k=(0,s.jsxs)(u.Zb,{hover:!1,children:[s.jsx(u.Ol,{title:e("testScrape")||"Run manual scrape",icon:"\uD83E\uDDEA"}),s.jsx("p",{style:{color:"var(--color-text-muted)",marginBottom:16},children:e("testScrapeDesc")||"Queue a real Amazon product URL to validate your connector."}),s.jsx(u.II,{placeholder:e("productUrl")||"Amazon product URL",value:p,onChange:e=>x(e.target.value),icon:s.jsx("span",{role:"img","aria-label":"link",children:"\uD83D\uDD17"}),style:{marginBottom:0}}),(0,s.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:12,marginTop:16},children:[s.jsx(u.zx,{type:"button",onClick:D,disabled:!p,loading:h,children:h?e("loading")||"Loading":e("run")||"Run test"}),s.jsx(u.zx,{type:"button",variant:"ghost",onClick:()=>x("https://www.amazon.com/dp/B0C1234567"),children:e("useSampleProduct")||"Use sample URL"})]})]});return(0,s.jsxs)(o.Z,{activeHref:"/ops",title:e("ops"),description:e("opsDesc")||"Monitor workers, queues, and manual validation",heroBadge:z,heroAside:E,heroFooter:s.jsx("span",{style:{color:"var(--color-text-muted)",fontSize:14},children:e("opsHeroFooter")||"Realtime queue data refreshes every 60 seconds."}),actions:A,toolbar:L,sidebar:P,children:[b&&s.jsx(u.bZ,{variant:"success"===b.type?"success":"warning"===b.type?"warning":"info"===b.type?"info":"error",children:b.text}),(0,s.jsxs)("div",{className:"grid grid-2",children:[(0,s.jsxs)(u.Zb,{hover:!1,children:[s.jsx(u.Ol,{title:e("queueHealth")||"Queue health",subtitle:e("queueHealthDesc")||"Understand automation backlog",icon:"\uD83D\uDCE6",action:(0,s.jsxs)(u.Ct,{variant:"info",children:[e("jobsTracked")||"Jobs tracked",": ",t?t.waiting+t.active:"—"]})}),g&&!t?s.jsx(u.TK,{text:e("loading")||"Loading"}):t?s.jsx("div",{className:"grid grid-2",children:w.map(e=>(0,s.jsxs)("div",{style:{background:"var(--color-elevated)",borderRadius:"var(--radius-lg)",padding:"16px",border:"1px solid var(--color-border)"},children:[s.jsx("span",{style:{fontSize:12,fontWeight:700,color:"var(--color-text-muted)",textTransform:"uppercase"},children:e.label}),s.jsx("div",{style:{fontSize:32,fontWeight:900,margin:"8px 0"},children:e.value}),s.jsx("span",{style:{color:"var(--color-text-muted)",fontSize:13},children:e.helper})]},e.key))}):s.jsx("p",{style:{color:"var(--color-text-muted)",margin:0},children:e("queueUnavailable")||"Queue metrics are unavailable. Refresh to try again."})]}),(0,s.jsxs)(u.Zb,{hover:!1,children:[s.jsx(u.Ol,{title:e("systemHealth")||"System health",subtitle:e("systemHealthDesc")||"Track service uptime and incidents",icon:"\uD83E\uDE7A",action:s.jsx(u.Ct,{variant:y?"success":"error",children:y?.timestamp?new Date(y.timestamp).toLocaleTimeString():e("noRecentData")||"No data"})}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[s.jsx(c.Z,{status:y?"FULFILLED":"FAILED",labels:{success:e("statusProcessed"),error:e("statusError"),pending:e("statusPending"),manual:e("ordersTableManual")}}),s.jsx("span",{style:{color:"var(--color-text-muted)"},children:y?e("statusHealthy")||"Healthy":e("systemIssuesDetected")||"Issues detected"})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:12},children:[s.jsx(u.Rm,{label:e("uptime")||"Uptime",value:y?"99.9%":"--",icon:"\uD83D\uDE80",color:y?"success":"warning"}),s.jsx(u.Rm,{label:e("alertsToday")||"Alerts",value:t?.failed??0,icon:"⚠️",color:"error"})]})]})]})]}),(0,s.jsxs)(u.Zb,{hover:!1,children:[s.jsx(u.Ol,{title:e("opsStatusSummary")||"Recent activity",icon:"\uD83D\uDCDD"}),r?s.jsx("ul",{style:{color:"var(--color-text-muted)",lineHeight:1.8,margin:0},children:q.map(e=>(0,s.jsxs)("li",{style:{listStyle:"disc",marginLeft:18},children:[(0,s.jsxs)("strong",{style:{color:"var(--color-text)"},children:[e.label,":"]})," ",e.value]},e.label))}):s.jsx("p",{style:{color:"var(--color-text-muted)",margin:0},children:g?e("loading")||"Loading":e("genericError")||"Unable to load activity"})]}),k]})}async function g({locale:e}){return{props:{...await (0,i.serverSideTranslations)(e,["common"])}}}d=(p.then?(await p)():p)[0],r()}catch(e){r(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[332,839,552,754,20],()=>a(1057));module.exports=r})();