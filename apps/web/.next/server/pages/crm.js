"use strict";(()=>{var e={};e.id=801,e.ids=[801,660],e.modules={6344:(e,t,l)=>{l.a(e,async(e,r)=>{try{l.r(t),l.d(t,{config:()=>y,default:()=>m,getServerSideProps:()=>x,getStaticPaths:()=>p,getStaticProps:()=>h,reportWebVitals:()=>v,routeModule:()=>D,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>g});var a=l(8877),i=l(4591),s=l(6021),o=l(552),n=l.n(o),c=l(4076),d=l(8431),u=e([d]);d=(u.then?(await u)():u)[0];let m=(0,s.l)(d,"default"),h=(0,s.l)(d,"getStaticProps"),p=(0,s.l)(d,"getStaticPaths"),x=(0,s.l)(d,"getServerSideProps"),y=(0,s.l)(d,"config"),v=(0,s.l)(d,"reportWebVitals"),g=(0,s.l)(d,"unstable_getStaticProps"),b=(0,s.l)(d,"unstable_getStaticPaths"),f=(0,s.l)(d,"unstable_getStaticParams"),j=(0,s.l)(d,"unstable_getServerProps"),S=(0,s.l)(d,"unstable_getServerSideProps"),D=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/crm",pathname:"/crm",bundlePath:"",filename:""},components:{App:c.default,Document:n()},userland:d});r()}catch(e){r(e)}})},8431:(e,t,l)=>{l.a(e,async(e,r)=>{try{l.r(t),l.d(t,{default:()=>y,getStaticProps:()=>v});var a=l(997),i=l(6689),s=l(5941),o=l(5460),n=l(1377),c=l(1522),d=l(5681),u=l(3688),m=l(1935),h=l(3877),p=l(7029),x=e([s,c]);[s,c]=x.then?(await x)():x;let g=e=>c.Z.get(e).then(e=>e.data);function y(){let{t:e}=(0,n.useTranslation)("common"),[t,l]=(0,i.useState)(""),[r,o]=(0,i.useState)(!1),[x,y]=(0,i.useState)(""),[v,b]=(0,i.useState)("all"),[f,j]=(0,i.useState)(null),[S,D]=(0,i.useState)(!1),[C,w]=(0,i.useState)(!1),[P,k]=(0,i.useState)(!1),[I,L]=(0,i.useState)("info"),[T,R]=(0,i.useState)("INQUIRY"),[N,z]=(0,i.useState)(""),[A,E]=(0,i.useState)("BRONZE"),[M,O]=(0,i.useState)(""),[$,B]=(0,i.useState)(!1),{data:U,mutate:F}=(0,s.default)(t?`/api/crm/${t}`:null,g),{data:W,mutate:Z}=(0,s.default)(t?`/api/crm/stats/${t}`:null,g),{data:V}=(0,s.default)(f?`/api/crm/${f.id}/interactions`:null,g),{data:q}=(0,s.default)(f?`/api/crm/${f.id}/loyalty`:null,g),_=!U&&t,H=(Array.isArray(U)?U:[]).filter(e=>{let t="all"===v||e.loyaltyTier===v,l=!x||e.name.toLowerCase().includes(x.toLowerCase())||e.email.toLowerCase().includes(x.toLowerCase());return t&&l}),G=async()=>{if(!f||!N.trim()){(0,p.M)(e("crmInteractionFieldsRequired")||"Please fill in all required fields","error");return}B(!0);try{await c.Z.post(`/api/crm/${f.id}/interactions`,{type:T,description:N}),(0,p.M)(e("crmInteractionAddSuccess")||"Interaction added successfully","success"),w(!1),z("")}catch(t){(0,p.M)(t.response?.data?.error||e("crmInteractionAddError")||"Failed to add interaction","error")}finally{B(!1)}},Q=async t=>{B(!0);try{await c.Z.post(`/api/crm/interactions/${t}/resolve`),(0,p.M)(e("crmInteractionResolveSuccess")||"Interaction resolved","success")}catch(t){(0,p.M)(t.response?.data?.error||e("crmInteractionResolveError")||"Failed to resolve interaction","error")}finally{B(!1)}},Y=async()=>{if(!f||!M.trim()){(0,p.M)(e("crmLoyaltyReasonRequired")||"Please provide a reason","error");return}B(!0);try{await c.Z.post(`/api/crm/${f.id}/loyalty`,{newTier:A,reason:M}),(0,p.M)(e("crmLoyaltyUpdateSuccess")||"Loyalty tier updated","success"),k(!1),O(""),F()}catch(t){(0,p.M)(t.response?.data?.error||e("crmLoyaltyUpdateError")||"Failed to update loyalty","error")}finally{B(!1)}},K=async(t,l)=>{B(!0);try{let r=l?`/api/crm/${t}/blacklist`:`/api/crm/${t}/unblacklist`;await c.Z.post(r),(0,p.M)(l?e("crmCustomerBlacklisted")||"Customer blacklisted successfully":e("crmCustomerUnblacklisted")||"Customer removed from blacklist","success"),F()}catch(t){(0,p.M)(t.response?.data?.error||e("crmCustomerStatusError")||"Failed to update customer status","error")}finally{B(!1)}},J=e=>{switch(e){case"PLATINUM":return"var(--color-secondary)";case"GOLD":return"#f59e0b";case"SILVER":return"#94a3b8";case"BRONZE":return"#a16207";default:return"var(--color-text-muted)"}},X=e=>{switch(e){case"PLATINUM":return"\uD83D\uDC8E";case"GOLD":return"\uD83E\uDD47";case"SILVER":return"\uD83E\uDD48";case"BRONZE":return"\uD83E\uDD49";default:return"\uD83D\uDC64"}},ee=e=>{switch(e){case"PURCHASE":return"\uD83D\uDED2";case"SUPPORT":return"\uD83C\uDFA7";case"COMPLAINT":return"âš ï¸";case"REFUND":return"\uD83D\uDCB8";case"INQUIRY":return"â“";default:return"\uD83D\uDCDD"}},et=t=>{switch(t){case"PLATINUM":return e("loyaltyPlatinum")||"Platinum";case"GOLD":return e("loyaltyGold")||"Gold";case"SILVER":return e("loyaltySilver")||"Silver";case"BRONZE":return e("loyaltyBronze")||"Bronze";default:return t}},el=t=>{switch(t){case"PURCHASE":return e("interactionPurchase")||"Purchase";case"SUPPORT":return e("interactionSupport")||"Support";case"COMPLAINT":return e("interactionComplaint")||"Complaint";case"REFUND":return e("interactionRefund")||"Refund";case"INQUIRY":return e("interactionInquiry")||"Inquiry";default:return t}},er=W?.totalCustomers??0,ea=W?.avgLifetimeValue??0,ei=W?.loyaltyDistribution?.PLATINUM??0,es=W?.churnRate??0,eo=W?.newCustomersThisMonth??0,en=W?.blacklistedCount??0,ec=()=>{},ed=a.jsx(h.Ct,{variant:t?"success":"warning",children:t?e("crmCustomersCountBadge",{count:H.length})||`${H.length} customers`:e("awaitingShopId")||"Awaiting shop ID"}),eu=a.jsx("div",{style:{display:"grid",gap:16,gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))"},children:[{label:e("totalCustomers")||"Total customers",value:t?er.toLocaleString():"--",helper:t?e("crmTotalCustomersHelper")||"Active contacts":e("crmConnectShopPrompt")||"Connect a shop to load data"},{label:e("avgLifetimeValue")||"Avg lifetime value",value:t?`$${ea.toFixed(2)}`:"--",helper:t?e("crmAverageLtvHelper")||"Per customer":e("crmConnectShopPrompt")||"Connect a shop to load data"},{label:e("newThisMonth")||"New this month",value:t?eo:"--",helper:t?e("crmNewThisMonthHelper")||"Fresh leads":e("crmConnectShopPrompt")||"Connect a shop to load data"}].map(e=>(0,a.jsxs)("div",{className:"stat-card",style:{padding:16},children:[a.jsx("p",{style:{fontSize:12,textTransform:"uppercase",color:"var(--color-text-light)",marginBottom:6},children:e.label}),a.jsx("div",{style:{fontSize:26,fontWeight:800},children:e.value}),a.jsx("p",{style:{margin:0,color:"var(--color-text-muted)",fontSize:13},children:e.helper})]},e.label))}),em=a.jsx("span",{style:{color:"var(--color-text-muted)",fontSize:14},children:e("crmHeroFooter")||"Sync customer health daily to keep loyalty automation accurate."}),eh=(0,a.jsxs)("div",{className:"stack-md wrap",style:{alignItems:"center"},children:[a.jsx("div",{className:"full-width-mobile",style:{flex:"1 1 220px",minWidth:200},children:a.jsx(h.II,{placeholder:e("shopIdPlaceholder")||"Shop ID",value:t,onChange:e=>l(e.target.value),"aria-label":e("shopId")||"Shop ID"})}),a.jsx("div",{className:"full-width-mobile",style:{flex:"1 1 220px",minWidth:200},children:a.jsx(h.II,{placeholder:e("searchCustomers")||"Search customers",value:x,onChange:e=>y(e.target.value),"aria-label":e("searchCustomers")||"Search customers",disabled:!t})}),a.jsx("div",{className:"full-width-mobile",style:{flex:"0 1 180px",minWidth:180},children:a.jsx(h.Ph,{value:v,onChange:e=>b(e.target.value),options:[{value:"all",label:e("allTiers")||"All tiers"},{value:"PLATINUM",label:`ðŸ’Ž ${et("PLATINUM")}`},{value:"GOLD",label:`ðŸ¥‡ ${et("GOLD")}`},{value:"SILVER",label:`ðŸ¥ˆ ${et("SILVER")}`},{value:"BRONZE",label:`ðŸ¥‰ ${et("BRONZE")}`}],disabled:!t})}),(0,a.jsxs)(h.zx,{type:"button",variant:"ghost",className:"full-width-mobile",onClick:()=>{if(!t){(0,p.M)(e("enterShopIdFirst")||"Enter a Shop ID to load data","error");return}F(),Z(),(0,p.M)(e("crmRefreshing")||"Refreshing CRM data","success")},children:["\uD83D\uDD04 ",e("refreshData")||"Refresh"]})]}),ep=(0,a.jsxs)("div",{className:"stack-md wrap",children:[(0,a.jsxs)(h.zx,{type:"button",className:"full-width-mobile",onClick:()=>window.open("/api/crm/export","_blank"),children:["â¬‡ï¸ ",e("exportCsv")||"Export CSV"]}),(0,a.jsxs)(h.zx,{type:"button",variant:"ghost",className:"full-width-mobile",onClick:ec,children:["\uD83E\uDDED ",e("replayTour")||"Replay tour"]})]}),ex=(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[(0,a.jsxs)(h.Zb,{hover:!1,children:[a.jsx(h.Ol,{title:e("crmQuickActions")||"Quick actions",subtitle:e("crmShortcutsSubtitle")||"Jump into common workflows",icon:"âš¡"}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,a.jsxs)(h.zx,{type:"button",variant:"ghost",onClick:()=>window.location.href="/notifications",children:["\uD83D\uDD14 ",e("notifySegment")||"Notify segment"]}),(0,a.jsxs)(h.zx,{type:"button",variant:"ghost",onClick:()=>window.location.href="/analytics",children:["\uD83D\uDCC8 ",e("viewAnalytics")||"View analytics"]}),(0,a.jsxs)(h.zx,{type:"button",onClick:()=>window.open("mailto:support@automation?subject=CRM%20Insights","_blank"),children:["\uD83D\uDCE4 ",e("shareInsights")||"Share insights"]})]})]}),(0,a.jsxs)(h.Zb,{hover:!1,children:[a.jsx(h.Ol,{title:e("crmPlaybooks")||"Playbooks",subtitle:e("crmPlaybooksSubtitle")||"Recommended next steps",icon:"\uD83D\uDCD8"}),(0,a.jsxs)("ul",{style:{margin:0,paddingLeft:20,color:"var(--color-text)",display:"flex",flexDirection:"column",gap:8},children:[a.jsx("li",{children:e("crmPlaybookRetention")||"Launch win-back campaign for dormant customers."}),a.jsx("li",{children:e("crmPlaybookLoyalty")||"Upgrade loyal buyers to the next tier automatically."}),a.jsx("li",{children:e("crmPlaybookBlacklist")||"Audit blacklisted accounts every Friday."})]})]})]});return(0,a.jsxs)(a.Fragment,{children:[a.jsx(d.Z,{activeHref:"/crm",title:`ðŸ‘¥ ${e("crmTitle")||"Customer Relationship Management"}`,description:e("crmHeroDescription")||e("crmDesc")||"Build relationships, track loyalty, and maximize customer lifetime value.",heroBadge:ed,heroAside:eu,heroFooter:em,toolbar:eh,actions:ep,sidebar:ex,heroBackground:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[!t&&a.jsx(h.bZ,{variant:"info",title:e("connectShop")||"Connect a shop",children:e("crmConnectShopDescription")||"Enter your Shop ID above to load CRM data."}),_&&a.jsx(h.TK,{text:e("loadingCustomers")||"Loading customers"}),t&&!_&&(0,a.jsxs)(a.Fragment,{children:[W&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{display:"grid",gap:16,gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:[a.jsx(h.Rm,{icon:"\uD83D\uDC65",label:e("totalCustomers")||"Total customers",value:W.totalCustomers.toLocaleString(),color:"primary"}),a.jsx(h.Rm,{icon:"\uD83D\uDCB0",label:e("avgLifetimeValue")||"Avg lifetime value",value:`$${W.avgLifetimeValue.toFixed(2)}`,color:"success"}),a.jsx(h.Rm,{icon:"\uD83D\uDC8E",label:e("platinumMembers")||"Platinum members",value:ei.toString(),color:"info"}),a.jsx(h.Rm,{icon:"\uD83D\uDEAB",label:e("blacklisted")||"Blacklisted",value:en.toString(),color:"error"})]}),(0,a.jsxs)(h.Zb,{children:[a.jsx(h.Ol,{title:`ðŸ† ${e("crmLoyaltyDistribution")||"Loyalty tier distribution"}`,subtitle:e("crmLoyaltySubtitle")||"Snapshot across all tiers"}),a.jsx("div",{style:{display:"grid",gap:16,gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))"},children:Object.entries(W.loyaltyDistribution).map(([e,t])=>(0,a.jsxs)("div",{style:{padding:20,background:"var(--color-elevated)",borderRadius:"var(--radius-lg)",textAlign:"center",border:"1px solid var(--color-border)"},children:[a.jsx("div",{style:{fontSize:32,marginBottom:8},children:X(e)}),a.jsx("div",{style:{fontSize:13,color:"var(--color-text-muted)",marginBottom:4,fontWeight:600},children:et(e)}),a.jsx("div",{style:{fontSize:24,fontWeight:700,color:J(e)},children:t})]},e))})]}),(0,a.jsxs)(h.Zb,{children:[a.jsx(h.Ol,{title:e("crmHealthPulse")||"Engagement pulse",subtitle:e("crmHealthPulseSubtitle")||"Monitor churn, acquisition, and loyalty",icon:"\uD83E\uDE7A"}),a.jsx("div",{style:{display:"grid",gap:16,gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))"},children:[{label:e("newThisMonth")||"New this month",value:eo,helper:e("crmNewThisMonthHelper")||"Fresh leads added"},{label:e("churnRate")||"Churn rate",value:`${(100*es).toFixed(1)}%`,helper:e("crmChurnHelper")||"Keep below 5%"},{label:e("platinumMembers")||"Platinum members",value:ei,helper:e("crmLoyaltyHelper")||"Top loyalty tier"}].map(e=>(0,a.jsxs)("div",{style:{padding:16,border:"1px solid var(--color-border)",borderRadius:"var(--radius-lg)",background:"var(--color-surface)"},children:[a.jsx("p",{style:{fontSize:13,color:"var(--color-text-muted)",marginBottom:4},children:e.label}),a.jsx("div",{style:{fontSize:28,fontWeight:800},children:e.value}),a.jsx("p",{style:{margin:0,fontSize:12,color:"var(--color-text-light)"},children:e.helper})]},e.label))})]})]}),H.length>0?(0,a.jsxs)(h.Zb,{children:[a.jsx(h.Ol,{title:`ðŸ“‹ ${e("crmCustomerListTitle")||"Customer list"}`,subtitle:e("crmCustomerListSubtitle",{count:H.length})||`${H.length} customers`}),a.jsx(h.iA,{columns:[{key:"customer",header:e("customer")||"Customer"},{key:"tier",header:e("tier")||"Tier",width:"140px"},{key:"orders",header:e("orders")||"Orders",width:"100px"},{key:"ltv",header:e("lifetimeValue")||"Lifetime value",width:"140px"},{key:"lastPurchase",header:e("lastPurchase")||"Last purchase",width:"130px"},{key:"status",header:e("status")||"Status",width:"120px"},{key:"actions",header:e("actions")||"Actions",width:"140px"}],data:H.map(t=>({_customer:t,customer:(0,a.jsxs)("div",{children:[a.jsx("div",{style:{fontWeight:600},children:t.name}),a.jsx("div",{style:{fontSize:13,color:"var(--color-text-muted)"},children:t.email})]}),tier:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("span",{style:{fontSize:20},children:X(t.loyaltyTier)}),a.jsx("span",{style:{fontWeight:600,color:J(t.loyaltyTier)},children:et(t.loyaltyTier)})]}),orders:a.jsx(h.Ct,{variant:"info",children:t.totalOrders}),ltv:(0,a.jsxs)("span",{style:{color:"var(--color-success)",fontWeight:600},children:["$",t.lifetimeValue.toLocaleString(void 0,{minimumFractionDigits:2})]}),lastPurchase:a.jsx("span",{style:{fontSize:13,color:"var(--color-text-muted)"},children:new Date(t.lastPurchase).toLocaleDateString()}),status:t.isBlacklisted?a.jsx(h.Ct,{variant:"error",children:e("blacklisted")||"Blacklisted"}):a.jsx(h.Ct,{variant:"success",children:e("active")||"Active"}),actions:a.jsx(h.zx,{variant:"ghost",size:"sm",onClick:()=>{j(t),D(!0)},children:e("viewDetails")||"View details"})})),onRowClick:e=>{j(e._customer),D(!0)}})]}):a.jsx(h.ub,{icon:"\uD83D\uDC65",title:e("noCustomersFound"),description:e("descriptionAdjustFilters"),action:a.jsx(h.zx,{type:"button",variant:"ghost",onClick:()=>{y(""),b("all")},children:e("resetFilters")||"Reset filters"})})]})]})}),f&&(0,a.jsxs)(h.u_,{isOpen:S,onClose:()=>{D(!1),j(null)},title:`${e("customer")||"Customer"}: ${f.name}`,size:"lg",children:[a.jsx(h.mQ,{defaultTab:I,onChange:L,tabs:[{id:"info",label:e("info")||"Info",icon:"\uD83D\uDC64",content:a.jsx(a.Fragment,{})},{id:"interactions",label:e("interactions")||"Interactions",icon:"\uD83D\uDCAC",badge:V?.length,content:a.jsx(a.Fragment,{})},{id:"loyalty",label:e("loyalty")||"Loyalty",icon:"\uD83C\uDFC6",content:a.jsx(a.Fragment,{})}]}),"info"===I&&(0,a.jsxs)("div",{style:{marginTop:24},children:[(0,a.jsxs)("div",{className:"grid grid-2",style:{gap:16,marginBottom:24},children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:e("email")||"Email"}),a.jsx("div",{style:{fontSize:15,color:"var(--color-text)"},children:f.email})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:e("phone")||"Phone"}),a.jsx("div",{style:{fontSize:15,color:"var(--color-text)"},children:f.phone||e("notAvailableShort")||"N/A"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:e("totalOrders")||"Total Orders"}),a.jsx("div",{style:{fontSize:15,color:"var(--color-text)"},children:f.totalOrders})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:e("lifetimeValue")||"Lifetime Value"}),(0,a.jsxs)("div",{style:{fontSize:15,color:"var(--color-success)",fontWeight:600},children:["$",f.lifetimeValue.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:e("loyaltyTier")||"Loyalty Tier"}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("span",{style:{fontSize:20},children:X(f.loyaltyTier)}),a.jsx("span",{style:{fontSize:15,fontWeight:600,color:J(f.loyaltyTier)},children:et(f.loyaltyTier)})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:e("memberSince")||"Member Since"}),a.jsx("div",{style:{fontSize:15,color:"var(--color-text)"},children:new Date(f.createdAt).toLocaleDateString()})]})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:12},children:[a.jsx(h.zx,{onClick:()=>k(!0),variant:"primary",fullWidth:!0,children:e("updateLoyaltyTier")||"Update Loyalty Tier"}),a.jsx(h.zx,{onClick:()=>K(f.id,!f.isBlacklisted),variant:f.isBlacklisted?"success":"danger",fullWidth:!0,children:f.isBlacklisted?e("crmUnblacklist")||"Unblacklist":e("crmBlacklist")||"Blacklist"})]})]}),"interactions"===I&&(0,a.jsxs)("div",{style:{marginTop:24},children:[(0,a.jsxs)(h.zx,{onClick:()=>w(!0),variant:"primary",fullWidth:!0,style:{marginBottom:16},children:["+ ",e("addInteraction")]}),V&&V.length>0?a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:V.map(t=>(0,a.jsxs)("div",{style:{padding:16,background:"var(--color-elevated)",borderRadius:"var(--radius-md)",border:"1px solid var(--color-border)"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("span",{style:{fontSize:20},children:ee(t.type)}),a.jsx(h.Ct,{variant:t.resolved?"success":"warning",children:el(t.type)})]}),a.jsx("span",{style:{fontSize:13,color:"var(--color-text-muted)"},children:new Date(t.createdAt).toLocaleDateString()})]}),a.jsx("p",{style:{margin:"8px 0",fontSize:14},children:t.description}),!t.resolved&&a.jsx(h.zx,{variant:"success",size:"sm",onClick:()=>Q(t.id),disabled:$,children:e("crmMarkResolved")||"Mark resolved"})]},t.id))}):a.jsx(h.ub,{icon:"\uD83D\uDCAC",title:e("noInteractions"),description:e("addFirstInteraction")})]}),"loyalty"===I&&a.jsx("div",{style:{marginTop:24},children:q&&q.length>0?a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:q.map(e=>(0,a.jsxs)("div",{style:{padding:16,background:"var(--color-elevated)",borderRadius:"var(--radius-md)",border:"1px solid var(--color-border)"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("span",{style:{fontSize:16},children:X(e.previousTier)}),a.jsx("span",{style:{color:J(e.previousTier),fontWeight:600},children:et(e.previousTier)}),a.jsx("span",{style:{margin:"0 8px",color:"var(--color-text-muted)"},children:"â†’"}),a.jsx("span",{style:{fontSize:16},children:X(e.newTier)}),a.jsx("span",{style:{color:J(e.newTier),fontWeight:600},children:et(e.newTier)})]}),a.jsx("span",{style:{fontSize:13,color:"var(--color-text-muted)"},children:new Date(e.createdAt).toLocaleDateString()})]}),a.jsx("p",{style:{margin:0,fontSize:14,color:"var(--color-text-muted)"},children:e.reason})]},e.id))}):a.jsx(h.ub,{icon:"\uD83C\uDFC6",title:e("noLoyaltyHistory"),description:e("loyaltyChangesAppear")})})]}),a.jsx(h.u_,{isOpen:C,onClose:()=>{w(!1),z("")},title:e("addCustomerInteraction"),children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[a.jsx(h.Ph,{label:e("interactionType")||"Interaction Type",value:T,onChange:e=>R(e.target.value),options:[{value:"PURCHASE",label:`ðŸ›’ ${el("PURCHASE")}`},{value:"SUPPORT",label:`ðŸŽ§ ${el("SUPPORT")}`},{value:"COMPLAINT",label:`âš ï¸ ${el("COMPLAINT")}`},{value:"REFUND",label:`ðŸ’¸ ${el("REFUND")}`},{value:"INQUIRY",label:`â“ ${el("INQUIRY")}`}]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:e("description")||"Description"}),a.jsx("textarea",{className:"input",value:N,onChange:e=>z(e.target.value),placeholder:e("describeInteraction"),rows:4,style:{width:"100%",resize:"vertical"}})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:12},children:[a.jsx(h.zx,{onClick:G,variant:"primary",fullWidth:!0,disabled:$,children:e("addInteraction")}),a.jsx(h.zx,{onClick:()=>w(!1),variant:"ghost",fullWidth:!0,children:e("cancel")})]})]})}),a.jsx(h.u_,{isOpen:P,onClose:()=>{k(!1),O("")},title:e("updateLoyaltyTier"),children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[a.jsx(h.Ph,{label:e("crmNewTierLabel")||"New tier",value:A,onChange:e=>E(e.target.value),options:[{value:"BRONZE",label:`ðŸ¥‰ ${et("BRONZE")}`},{value:"SILVER",label:`ðŸ¥ˆ ${et("SILVER")}`},{value:"GOLD",label:`ðŸ¥‡ ${et("GOLD")}`},{value:"PLATINUM",label:`ðŸ’Ž ${et("PLATINUM")}`}]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:e("tierChangeReason")||e("reason")||"Reason"}),a.jsx("textarea",{className:"input",value:M,onChange:e=>O(e.target.value),placeholder:e("whyTierChanged"),rows:3,style:{width:"100%",resize:"vertical"}})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:12},children:[a.jsx(h.zx,{onClick:Y,variant:"primary",fullWidth:!0,disabled:$,children:e("updateLoyaltyTier")||"Update tier"}),a.jsx(h.zx,{onClick:()=>k(!1),variant:"ghost",fullWidth:!0,children:e("cancel")||"Cancel"})]})]})}),a.jsx(p.Z,{}),a.jsx(u.Z,{pageName:"crm",steps:m.GS,onComplete:()=>o(!1)}),!r&&a.jsx(u.M,{onClick:ec})]})}async function v({locale:e}){return{props:{...await (0,o.serverSideTranslations)(e,["common"])}}}r()}catch(e){r(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9648:e=>{e.exports=import("axios")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var l=e=>t(t.s=e),r=t.X(0,[332,839,552,754,20,198],()=>l(6344));module.exports=r})();