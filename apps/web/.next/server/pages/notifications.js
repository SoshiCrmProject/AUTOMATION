"use strict";(()=>{var e={};e.id=769,e.ids=[769,660],e.modules={3667:(e,t,a)=>{a.a(e,async(e,i)=>{try{a.r(t),a.d(t,{config:()=>g,default:()=>p,getServerSideProps:()=>v,getStaticPaths:()=>x,getStaticProps:()=>h,reportWebVitals:()=>y,routeModule:()=>b,unstable_getServerProps:()=>C,unstable_getServerSideProps:()=>j,unstable_getStaticParams:()=>m,unstable_getStaticPaths:()=>D,unstable_getStaticProps:()=>f});var n=a(8877),r=a(4591),l=a(6021),s=a(552),o=a.n(s),c=a(5270),d=a(7422),u=e([d]);d=(u.then?(await u)():u)[0];let p=(0,l.l)(d,"default"),h=(0,l.l)(d,"getStaticProps"),x=(0,l.l)(d,"getStaticPaths"),v=(0,l.l)(d,"getServerSideProps"),g=(0,l.l)(d,"config"),y=(0,l.l)(d,"reportWebVitals"),f=(0,l.l)(d,"unstable_getStaticProps"),D=(0,l.l)(d,"unstable_getStaticPaths"),m=(0,l.l)(d,"unstable_getStaticParams"),C=(0,l.l)(d,"unstable_getServerProps"),j=(0,l.l)(d,"unstable_getServerSideProps"),b=new n.PagesRouteModule({definition:{kind:r.x.PAGES,page:"/notifications",pathname:"/notifications",bundlePath:"",filename:""},components:{App:c.default,Document:o()},userland:d});i()}catch(e){i(e)}})},7422:(e,t,a)=>{a.a(e,async(e,i)=>{try{a.r(t),a.d(t,{default:()=>x,getStaticProps:()=>v});var n=a(997),r=a(6689),l=a(5941),s=a(5460),o=a(1377),c=a(1522),d=a(2684),u=a(3877),p=a(7029),h=e([l,c]);[l,c]=h.then?(await h)():h;let g=e=>c.Z.get(e).then(e=>e.data);function x(){let{t:e}=(0,o.useTranslation)("common"),[t,a]=(0,r.useState)(""),[i,s]=(0,r.useState)(""),[h,x]=(0,r.useState)(!1),[v,y]=(0,r.useState)(!1),[f,D]=(0,r.useState)(!1),[m,C]=(0,r.useState)({name:"",type:"EMAIL",config:{}}),[j,b]=(0,r.useState)({name:"",event:"ORDER_PLACED",channelId:"",priority:"MEDIUM",template:""}),{data:S,mutate:A}=(0,l.default)(t?`/api/notifications/channels/${t}`:null,g),{data:E,mutate:I}=(0,l.default)(t?`/api/notifications/rules?shopId=${t}`:null,g),{data:w,mutate:R}=(0,l.default)(t?`/api/notifications/history?shopId=${t}&limit=50`:null,g),P=e=>{switch(e){case"EMAIL":return"\uD83D\uDCE7";case"SMS":return"\uD83D\uDCF1";case"SLACK":return"\uD83D\uDCAC";case"DISCORD":return"\uD83C\uDFAE";case"WEBHOOK":return"\uD83D\uDD17";default:return"\uD83D\uDD14"}},M=e=>{switch(e){case"CRITICAL":return"error";case"HIGH":return"warning";case"MEDIUM":default:return"info";case"LOW":return"success"}},k=e=>{switch(e){case"SENT":return"success";case"FAILED":return"error";case"PENDING":return"warning";default:return"info"}},z=async e=>{try{await c.Z.post(`/api/notifications/test/${e}`),(0,p.M)("Test notification sent successfully","success"),R()}catch(e){(0,p.M)("Failed to send test notification","error")}},O=async()=>{if(!t||!m.name){(0,p.M)("Please fill in required fields","error");return}D(!0);try{await c.Z.post("/api/notifications/channels",{shopId:t,...m}),(0,p.M)("Channel created successfully","success"),x(!1),C({name:"",type:"EMAIL",config:{}}),A()}catch(e){(0,p.M)(e.response?.data?.error||"Failed to create channel","error")}finally{D(!1)}},N=async()=>{if(!t||!j.name||!j.channelId){(0,p.M)("Please fill in required fields","error");return}D(!0);try{await c.Z.post("/api/notifications/rules",{shopId:t,...j}),(0,p.M)("Rule created successfully","success"),y(!1),b({name:"",event:"ORDER_PLACED",channelId:"",priority:"MEDIUM",template:""}),I()}catch(e){(0,p.M)(e.response?.data?.error||"Failed to create rule","error")}finally{D(!1)}},T=async(e,t)=>{try{await c.Z.patch(`/api/notifications/channels/${e}`,{isActive:t}),(0,p.M)(`Channel ${t?"activated":"deactivated"}`,"success"),A()}catch(e){(0,p.M)("Failed to update channel","error")}},L=async(e,t)=>{try{await c.Z.patch(`/api/notifications/rules/${e}`,{isActive:t}),(0,p.M)(`Rule ${t?"activated":"deactivated"}`,"success"),I()}catch(e){(0,p.M)("Failed to update rule","error")}},_=async e=>{if(confirm("Are you sure you want to delete this channel?"))try{await c.Z.delete(`/api/notifications/channels/${e}`),(0,p.M)("Channel deleted","success"),A()}catch(e){(0,p.M)("Failed to delete channel","error")}},F=Array.isArray(S)?S:[],W=Array.isArray(E)?E:[],q=Array.isArray(w)?w:[],Z={totalChannels:F.length,activeChannels:F.filter(e=>e.isActive).length,totalRules:W.length,activeRules:W.filter(e=>e.isActive).length,sentToday:q.filter(e=>{let t=new Date(e.sentAt),a=new Date;return t.toDateString()===a.toDateString()}).length,failedToday:q.filter(e=>{let t=new Date(e.sentAt),a=new Date;return t.toDateString()===a.toDateString()&&"FAILED"===e.status}).length};return(0,n.jsxs)("div",{className:"shell",children:[n.jsx(d.Z,{activeHref:"/notifications"}),n.jsx(p.Z,{}),(0,n.jsxs)("div",{className:"container",children:[n.jsx("div",{style:{background:"linear-gradient(135deg, #f59e0b 0%, #ef4444 100%)",padding:"48px 32px",borderRadius:"var(--radius-xl)",marginBottom:32,boxShadow:"var(--shadow-lg)"},children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"20px"},children:[(0,n.jsxs)("div",{children:[n.jsx("h1",{style:{fontSize:36,margin:0,color:"#fff"},children:"\uD83D\uDD14 Notification Center"}),n.jsx("p",{style:{color:"rgba(255,255,255,0.9)",marginTop:8,fontSize:16},children:"Multi-channel notifications, automation rules, and delivery tracking"})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[n.jsx(u.zx,{onClick:()=>x(!0),disabled:!t,variant:"ghost",children:"➕ Add Channel"}),n.jsx(u.zx,{onClick:()=>y(!0),disabled:!t,variant:"ghost",children:"⚙️ Add Rule"})]})]})}),n.jsx("div",{style:{marginBottom:24},children:n.jsx(u.Zb,{children:n.jsx(u.II,{label:"Shop ID",value:t,onChange:e=>a(e.target.value),placeholder:"Enter Shop ID to manage notifications"})})}),!t&&n.jsx(u.bZ,{variant:"info",title:"Get Started",children:"Enter your Shop ID above to configure notification channels and rules"}),"        ",t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"grid grid-4",style:{marginBottom:24},children:[n.jsx(u.Rm,{icon:"\uD83D\uDCE1",label:"Total Channels",value:Z.totalChannels.toString(),color:"primary",trend:Z.activeChannels}),n.jsx(u.Rm,{icon:"⚙️",label:"Active Rules",value:Z.activeRules.toString(),color:"info"}),n.jsx(u.Rm,{icon:"\uD83D\uDCE4",label:"Sent Today",value:Z.sentToday.toString(),color:"success"}),n.jsx(u.Rm,{icon:"⚠️",label:"Failed Today",value:Z.failedToday.toString(),color:"error"})]}),n.jsx(u.Zb,{children:n.jsx(u.mQ,{tabs:[{id:"channels",label:"Channels",icon:"\uD83D\uDCE1",badge:F.length,content:n.jsx("div",{style:{padding:"24px"},children:F.length>0?n.jsx("div",{className:"grid grid-3",style:{gap:"20px"},children:F.map(e=>(0,n.jsxs)("div",{style:{padding:"24px",background:"var(--color-elevated)",borderRadius:"var(--radius-lg)",border:`2px solid ${e.isActive?"var(--color-success)":"var(--color-border)"}`,transition:"all 0.2s",opacity:e.isActive?1:.7},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"start",justifyContent:"space-between",marginBottom:"16px"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[n.jsx("span",{style:{fontSize:"32px"},children:P(e.type)}),(0,n.jsxs)("div",{children:[n.jsx("h4",{style:{margin:0,fontSize:"16px"},children:e.name}),n.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",margin:"4px 0 0"},children:e.type})]})]}),n.jsx(u.Ct,{variant:e.isActive?"success":"error",children:e.isActive?"Active":"Inactive"})]}),(0,n.jsxs)("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginBottom:"16px"},children:["Created: ",new Date(e.createdAt).toLocaleDateString()]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[n.jsx(u.zx,{variant:"primary",size:"sm",onClick:()=>z(e.id),disabled:!e.isActive,fullWidth:!0,children:"Test"}),n.jsx(u.zx,{variant:e.isActive?"warning":"success",size:"sm",onClick:()=>T(e.id,!e.isActive),fullWidth:!0,children:e.isActive?"Disable":"Enable"}),n.jsx(u.zx,{variant:"danger",size:"sm",onClick:()=>_(e.id),children:"\uD83D\uDDD1️"})]})]},e.id))}):n.jsx(u.ub,{icon:"\uD83D\uDCE1",title:"No Channels Configured",description:"Add your first notification channel to start sending alerts",action:n.jsx(u.zx,{onClick:()=>x(!0),children:"➕ Add Channel"})})})},{id:"rules",label:"Rules",icon:"⚙️",badge:W.length,content:n.jsx("div",{style:{padding:"24px"},children:W.length>0?n.jsx(u.iA,{columns:[{key:"name",header:"Rule Name"},{key:"event",header:"Event",width:"150px"},{key:"channel",header:"Channel",width:"150px",render:e=>{let t=F.find(t=>t.id===e.channelId);return t?(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("span",{children:P(t.type)}),n.jsx("span",{style:{fontSize:"13px"},children:t.name})]}):"Unknown"}},{key:"priority",header:"Priority",width:"120px",render:e=>n.jsx(u.Ct,{variant:M(e.priority),children:e.priority})},{key:"status",header:"Status",width:"100px",render:e=>n.jsx(u.Ct,{variant:e.isActive?"success":"error",children:e.isActive?"Active":"Inactive"})},{key:"actions",header:"Actions",width:"120px",render:e=>n.jsx(u.zx,{variant:e.isActive?"warning":"success",size:"sm",onClick:()=>L(e.id,!e.isActive),children:e.isActive?"Disable":"Enable"})}],data:W}):n.jsx(u.ub,{icon:"⚙️",title:"No Notification Rules",description:"Create automation rules to send notifications based on events",action:n.jsx(u.zx,{onClick:()=>y(!0),children:"⚙️ Add Rule"})})})},{id:"history",label:"History",icon:"\uD83D\uDCDC",badge:q.length,content:n.jsx("div",{style:{padding:"24px"},children:q.length>0?n.jsx(u.iA,{columns:[{key:"subject",header:"Subject",render:e=>(0,n.jsxs)("div",{children:[n.jsx("div",{style:{fontWeight:600},children:e.subject}),(0,n.jsxs)("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",marginTop:"4px"},children:[e.message.substring(0,80),"..."]})]})},{key:"priority",header:"Priority",width:"100px",render:e=>n.jsx(u.Ct,{variant:M(e.priority),children:e.priority})},{key:"status",header:"Status",width:"100px",render:e=>n.jsx(u.Ct,{variant:k(e.status),children:e.status})},{key:"channel",header:"Channel",width:"120px",render:e=>{let t=F.find(t=>t.id===e.channelId);return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("span",{children:P(t?.type||"UNKNOWN")}),n.jsx("span",{style:{fontSize:"12px"},children:t?.type||"Unknown"})]})}},{key:"sentAt",header:"Sent At",width:"160px",render:e=>n.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:new Date(e.sentAt).toLocaleString()})},{key:"error",header:"Error",width:"80px",render:e=>e.errorMessage?n.jsx("span",{style:{fontSize:"12px",color:"var(--color-error)",cursor:"pointer"},title:e.errorMessage,children:"⚠️ Error"}):null}],data:q}):n.jsx(u.ub,{icon:"\uD83D\uDCDC",title:"No Notification History",description:"Sent notifications will appear here"})})}]})})]})]}),n.jsx(u.u_,{isOpen:h,onClose:()=>{x(!1),C({name:"",type:"EMAIL",config:{}})},title:"Add Notification Channel",children:(0,n.jsxs)("div",{style:{padding:"24px",display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsx(u.II,{label:"Channel Name",value:m.name,onChange:e=>C({...m,name:e.target.value}),placeholder:"e.g., Primary Email"}),n.jsx(u.Ph,{label:"Channel Type",value:m.type,onChange:e=>C({...m,type:e.target.value}),options:[{value:"EMAIL",label:"\uD83D\uDCE7 Email"},{value:"SMS",label:"\uD83D\uDCF1 SMS"},{value:"SLACK",label:"\uD83D\uDCAC Slack"},{value:"DISCORD",label:"\uD83C\uDFAE Discord"},{value:"WEBHOOK",label:"\uD83D\uDD17 Webhook"}]}),n.jsx(u.bZ,{variant:"info",children:"Channel configuration can be set after creation"}),(0,n.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[n.jsx(u.zx,{onClick:O,disabled:f,fullWidth:!0,children:f?"Creating...":"Create Channel"}),n.jsx(u.zx,{onClick:()=>x(!1),variant:"ghost",fullWidth:!0,children:"Cancel"})]})]})}),n.jsx(u.u_,{isOpen:v,onClose:()=>{y(!1),b({name:"",event:"ORDER_PLACED",channelId:"",priority:"MEDIUM",template:""})},title:"Create Notification Rule",size:"lg",children:(0,n.jsxs)("div",{style:{padding:"24px",display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsx(u.II,{label:"Rule Name",value:j.name,onChange:e=>b({...j,name:e.target.value}),placeholder:"e.g., Order Confirmation"}),n.jsx(u.Ph,{label:"Trigger Event",value:j.event,onChange:e=>b({...j,event:e.target.value}),options:[{value:"ORDER_PLACED",label:"Order Placed"},{value:"ORDER_PAID",label:"Order Paid"},{value:"ORDER_SHIPPED",label:"Order Shipped"},{value:"ORDER_FAILED",label:"Order Failed"},{value:"LOW_STOCK",label:"Low Stock Alert"},{value:"PRICE_CHANGE",label:"Price Changed"},{value:"ERROR_OCCURRED",label:"Error Occurred"}]}),n.jsx(u.Ph,{label:"Notification Channel",value:j.channelId,onChange:e=>b({...j,channelId:e.target.value}),options:[{value:"",label:"Select channel..."},...F.filter(e=>e.isActive).map(e=>({value:e.id,label:`${P(e.type)} ${e.name} (${e.type})`}))]}),n.jsx(u.Ph,{label:"Priority",value:j.priority,onChange:e=>b({...j,priority:e.target.value}),options:[{value:"LOW",label:"\uD83D\uDFE2 Low"},{value:"MEDIUM",label:"\uD83D\uDFE1 Medium"},{value:"HIGH",label:"\uD83D\uDFE0 High"},{value:"CRITICAL",label:"\uD83D\uDD34 Critical"}]}),(0,n.jsxs)("div",{children:[n.jsx("label",{className:"label",children:"Message Template"}),n.jsx("textarea",{className:"input",value:j.template,onChange:e=>b({...j,template:e.target.value}),placeholder:"Use {{variables}} for dynamic content",rows:4,style:{width:"100%",resize:"vertical",fontFamily:"monospace",fontSize:"13px"}}),(0,n.jsxs)("p",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginTop:"8px"},children:["Available variables: ","{","{"," orderId ","}","}",", ","{","{"," customerName ","}","}",", ","{","{"," amount ","}","}",", ","{","{"," status ","}","}"]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[n.jsx(u.zx,{onClick:N,disabled:f||!j.channelId,fullWidth:!0,children:f?"Creating...":"Create Rule"}),n.jsx(u.zx,{onClick:()=>y(!1),variant:"ghost",fullWidth:!0,children:"Cancel"})]})]})})]})}async function v({locale:e}){return{props:{...await (0,s.serverSideTranslations)(e,["common"])}}}i()}catch(e){i(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9648:e=>{e.exports=import("axios")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),i=t.X(0,[332,839,552,754,52,877],()=>a(3667));module.exports=i})();