"use strict";(()=>{var e={};e.id=411,e.ids=[411,660],e.modules={8136:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{config:()=>g,default:()=>p,getServerSideProps:()=>m,getStaticPaths:()=>h,getStaticProps:()=>x,reportWebVitals:()=>v,routeModule:()=>S,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>R,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>j});var a=t(8877),n=t(4591),l=t(6021),i=t(552),d=t.n(i),o=t(5270),c=t(2669),u=e([c]);c=(u.then?(await u)():u)[0];let p=(0,l.l)(c,"default"),x=(0,l.l)(c,"getStaticProps"),h=(0,l.l)(c,"getStaticPaths"),m=(0,l.l)(c,"getServerSideProps"),g=(0,l.l)(c,"config"),v=(0,l.l)(c,"reportWebVitals"),j=(0,l.l)(c,"unstable_getStaticProps"),y=(0,l.l)(c,"unstable_getStaticPaths"),f=(0,l.l)(c,"unstable_getStaticParams"),b=(0,l.l)(c,"unstable_getServerProps"),R=(0,l.l)(c,"unstable_getServerSideProps"),S=new a.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/review",pathname:"/review",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:c});s()}catch(e){s(e)}})},2669:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{default:()=>h,getStaticProps:()=>m});var a=t(997),n=t(6689),l=t(5941),i=t(5460),d=t(1377),o=t(1522),c=t(6555),u=t(4202),p=t(7029),x=e([l,o]);[l,o]=x.then?(await x)():x;let g=e=>o.Z.get(e).then(e=>e.data);function h(){let{t:e}=(0,d.useTranslation)("common"),[r,t]=(0,n.useState)(""),[s,i]=(0,n.useState)(null),[x,h]=(0,n.useState)(!1),[m,v]=(0,n.useState)(!1),[j,y]=(0,n.useState)(!1),[f,b]=(0,n.useState)(null),[R,S]=(0,n.useState)("APPROVE"),[D,A]=(0,n.useState)(0),[P,w]=(0,n.useState)(""),{data:N,error:C,mutate:k}=(0,l.default)("/orders/errors",g,{revalidateOnFocus:!1}),{data:E,mutate:O}=(0,l.default)(r?`/api/returns?shopId=${r}`:null,g),z=Array.isArray(N)?N.filter(e=>e.reason?.toLowerCase().includes("manual review")||e.reason?.toLowerCase().includes("review")):[],I=Array.isArray(E)?E:[],q=async e=>{b(e);try{await o.Z.post(`/orders/retry/${e}`),(0,p.M)("Order retry successful","success"),k()}catch(e){(0,p.M)(e?.response?.data?.error||"Retry failed","error")}finally{b(null)}},L=async()=>{if(s){y(!0);try{let e="APPROVE"===R?`/api/returns/${s.id}/approve`:`/api/returns/${s.id}/reject`;await o.Z.post(e,{refundAmount:"APPROVE"===R?D:void 0,notes:P}),(0,p.M)(`Return ${R.toLowerCase()}d successfully`,"success"),v(!1),i(null),w(""),O()}catch(e){(0,p.M)(e.response?.data?.error||"Failed to process return","error")}finally{y(!1)}}},M=async e=>{y(!0);try{await o.Z.post(`/api/returns/${e}/complete`),(0,p.M)("Return completed successfully","success"),O()}catch(e){(0,p.M)(e.response?.data?.error||"Failed to complete return","error")}finally{y(!1)}},V=e=>{switch(e){case"PENDING":return"warning";case"APPROVED":default:return"info";case"REJECTED":return"error";case"REFUNDED":case"COMPLETED":return"success"}},_={pending:I.filter(e=>"PENDING"===e.status).length,approved:I.filter(e=>"APPROVED"===e.status).length,refunded:I.filter(e=>"REFUNDED"===e.status).length,total:I.length,totalRefundAmount:I.filter(e=>"REFUNDED"===e.status||"APPROVED"===e.status).reduce((e,r)=>e+r.refundAmount,0)};return(0,a.jsxs)("div",{className:"shell",children:[a.jsx(c.Z,{activeHref:"/review"}),a.jsx(p.Z,{}),(0,a.jsxs)("div",{className:"container",children:[(0,a.jsxs)("div",{style:{background:"linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%)",padding:"48px 32px",borderRadius:"var(--radius-xl)",marginBottom:32,boxShadow:"var(--shadow-lg)"},children:[a.jsx("h1",{style:{fontSize:36,margin:0,color:"#fff"},children:"\uD83D\uDD04 Returns & Manual Review Center"}),a.jsx("p",{style:{color:"rgba(255,255,255,0.9)",marginTop:8,fontSize:16},children:"Process returns, manage refunds, and handle manual review items"})]}),a.jsx("div",{style:{marginBottom:32},children:(0,a.jsxs)(u.Zb,{children:[a.jsx(u.Ol,{title:"⚠️ Manual Review Queue",subtitle:e("ordersRequiringAttention"),icon:"\uD83D\uDC41️"}),C&&a.jsx(u.bZ,{variant:"error",title:e("errorLoadingReviewItems"),children:C.message}),0===z.length?(0,a.jsxs)("div",{style:{padding:"60px",textAlign:"center"},children:[a.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"✅"}),a.jsx("h3",{style:{marginBottom:"8px"},children:"No Items Need Review"}),a.jsx("p",{style:{color:"var(--color-text-muted)"},children:"All orders are processing normally"})]}):a.jsx(u.iA,{columns:[{key:"orderId",header:"Order ID"},{key:"reason",header:"Reason"},{key:"date",header:"Date",width:"150px",render:e=>a.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:new Date(e.createdAt).toLocaleString()})},{key:"actions",header:"Actions",width:"140px",render:e=>a.jsx(u.zx,{size:"sm",onClick:()=>q(e.shopeeOrderId),disabled:f===e.shopeeOrderId,children:f===e.shopeeOrderId?"Retrying...":"Retry"})}],data:z.map(e=>({orderId:e.shopeeOrderId||"-",reason:e.reason,createdAt:e.createdAt,shopeeOrderId:e.shopeeOrderId}))})]})}),(0,a.jsxs)(u.Zb,{children:[a.jsx(u.Ol,{title:"\uD83D\uDD04 Returns Management",subtitle:e("manageReturns"),icon:"\uD83D\uDCB0"}),a.jsx("div",{style:{padding:"0 24px 24px"},children:a.jsx(u.II,{label:"Shop ID",value:r,onChange:e=>t(e.target.value),placeholder:e("enterShopIDReturns")})}),!r&&a.jsx("div",{style:{margin:"0 24px 24px"},children:a.jsx(u.bZ,{variant:"info",children:"Enter your Shop ID above to manage returns and refunds"})}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-4",style:{gap:"16px",padding:"0 24px 24px"},children:[a.jsx(u.Rm,{icon:"\uD83D\uDCCB",label:"Total Returns",value:_.total.toString(),color:"primary"}),a.jsx(u.Rm,{icon:"⏳",label:"Pending",value:_.pending.toString(),color:"warning"}),a.jsx(u.Rm,{icon:"✅",label:"Approved",value:_.approved.toString(),color:"info"}),a.jsx(u.Rm,{icon:"\uD83D\uDCB0",label:"Total Refunded",value:`\xa5${_.totalRefundAmount.toLocaleString()}`,color:"success"})]}),I.length>0?a.jsx(u.mQ,{tabs:[{id:"pending",label:"Pending",icon:"⏳",badge:_.pending,content:a.jsx("div",{style:{padding:"24px"},children:a.jsx(u.iA,{columns:[{key:"rma",header:"RMA#",width:"120px"},{key:"customer",header:"Customer",render:e=>(0,a.jsxs)("div",{children:[a.jsx("div",{style:{fontWeight:600},children:e.customerName}),a.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:e.customerEmail})]})},{key:"reason",header:"Reason"},{key:"amount",header:"Amount",width:"120px",render:e=>(0,a.jsxs)("span",{style:{fontWeight:600,color:"var(--color-error)"},children:["\xa5",e.refundAmount.toLocaleString()]})},{key:"date",header:"Requested",width:"150px",render:e=>a.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:new Date(e.requestedAt).toLocaleDateString()})},{key:"actions",header:"Actions",width:"180px",render:e=>(0,a.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[a.jsx(u.zx,{size:"sm",variant:"ghost",onClick:()=>{i(e),h(!0)},children:"Details"}),a.jsx(u.zx,{size:"sm",variant:"success",onClick:()=>{i(e),A(e.refundAmount),v(!0)},children:"Process"})]})}],data:I.filter(e=>"PENDING"===e.status)})})},{id:"approved",label:"Approved",icon:"✅",badge:_.approved,content:a.jsx("div",{style:{padding:"24px"},children:a.jsx(u.iA,{columns:[{key:"rma",header:"RMA#",width:"120px",render:e=>e.rmaNumber},{key:"customer",header:"Customer",render:e=>e.customerName},{key:"amount",header:"Refund Amount",width:"120px",render:e=>`\xa5${e.refundAmount.toLocaleString()}`},{key:"approved",header:"Approved",width:"150px",render:e=>new Date(e.approvedAt).toLocaleDateString()},{key:"actions",header:"Actions",width:"140px",render:e=>a.jsx(u.zx,{size:"sm",variant:"success",onClick:()=>M(e.id),disabled:j,children:"Complete"})}],data:I.filter(e=>"APPROVED"===e.status)})})},{id:"all",label:"All Returns",icon:"\uD83D\uDCCB",badge:I.length,content:a.jsx("div",{style:{padding:"24px"},children:a.jsx(u.iA,{columns:[{key:"rma",header:"RMA#",width:"120px",render:e=>e.rmaNumber},{key:"customer",header:"Customer",render:e=>e.customerName},{key:"reason",header:"Reason"},{key:"status",header:"Status",width:"120px",render:e=>a.jsx(u.Ct,{variant:V(e.status),children:e.status})},{key:"amount",header:"Amount",width:"120px",render:e=>`\xa5${e.refundAmount.toLocaleString()}`},{key:"date",header:"Requested",width:"130px",render:e=>new Date(e.requestedAt).toLocaleDateString()}],data:I})})}]}):a.jsx(u.ub,{icon:"\uD83D\uDD04",title:e("noReturnsFound"),description:e("descriptionReturnRequests")})]})]})]}),s&&a.jsx(u.u_,{isOpen:x,onClose:()=>{h(!1),i(null)},title:`Return Details - ${s.rmaNumber}`,children:a.jsx("div",{style:{padding:"24px"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Customer"}),a.jsx("div",{style:{fontSize:"15px",fontWeight:600},children:s.customerName}),a.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:s.customerEmail})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Order ID"}),a.jsx("div",{style:{fontSize:"15px"},children:s.shopOrderId})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Return Reason"}),a.jsx("div",{style:{fontSize:"15px"},children:s.reason})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Refund Amount"}),(0,a.jsxs)("div",{style:{fontSize:"20px",fontWeight:700,color:"var(--color-error)"},children:["\xa5",s.refundAmount.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Status"}),a.jsx(u.Ct,{variant:V(s.status),children:s.status})]}),s.notes&&(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Notes"}),a.jsx("div",{style:{padding:"12px",background:"var(--color-elevated)",borderRadius:"var(--radius-md)",fontSize:"14px"},children:s.notes})]}),(0,a.jsxs)("div",{className:"grid grid-2",style:{gap:"12px",fontSize:"13px",color:"var(--color-text-muted)"},children:[(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Requested:"})," ",new Date(s.requestedAt).toLocaleString()]}),s.approvedAt&&(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Approved:"})," ",new Date(s.approvedAt).toLocaleString()]})]})]})})}),a.jsx(u.u_,{isOpen:m,onClose:()=>{v(!1),i(null),w("")},title:e("processReturnRequest"),children:(0,a.jsxs)("div",{style:{padding:"24px",display:"flex",flexDirection:"column",gap:"16px"},children:[s&&(0,a.jsxs)(u.bZ,{variant:"info",children:["Processing return for ",a.jsx("strong",{children:s.customerName})," (",s.rmaNumber,")"]}),a.jsx(u.Ph,{label:"Action",value:R,onChange:e=>S(e.target.value),options:[{value:"APPROVE",label:"✅ Approve Return"},{value:"REJECT",label:"❌ Reject Return"}]}),"APPROVE"===R&&a.jsx(u.II,{label:"Refund Amount (\xa5)",type:"number",value:D,onChange:e=>A(Number(e.target.value))}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Notes"}),a.jsx("textarea",{className:"input",value:P,onChange:e=>w(e.target.value),placeholder:e("addInternalNotes"),rows:4,style:{width:"100%",resize:"vertical"}})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[a.jsx(u.zx,{onClick:L,disabled:j,variant:"APPROVE"===R?"success":"danger",fullWidth:!0,children:j?"Processing...":`${"APPROVE"===R?"Approve":"Reject"} Return`}),a.jsx(u.zx,{onClick:()=>v(!1),variant:"ghost",fullWidth:!0,children:e("cancel")})]})]})})]})}async function m({locale:e}){return{props:{...await (0,i.serverSideTranslations)(e,["common"])}}}s()}catch(e){s(e)}})},1377:e=>{e.exports=require("next-i18next")},5460:e=>{e.exports=require("next-i18next/serverSideTranslations")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9816:e=>{e.exports=require("styled-jsx/style")},9648:e=>{e.exports=import("axios")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var r=require("../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[332,839,552,754,107,202],()=>t(8136));module.exports=s})();